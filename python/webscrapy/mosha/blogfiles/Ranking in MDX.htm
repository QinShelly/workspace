


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    
<head>
<title>Microsoft OLAP by Mosha Pasumansky : Ranking in MDX</title>
<meta name="keywords" content="performance,mdx" />
<meta name="description" content="Well, apparently I am one of the industry influencers ! At least this is what Kimball Group thinks, because they sent me their just published &amp;quot;The Microsoft Data Warehouse Toolkit: With SQL Server 2005 and the Microsoft Business Intelligence Toolset&amp;quot;" />
<meta name="GENERATOR" content="CommunityServer 2.1 SP2 (Build: 61129.1)" />
<link rel="pingback" href="http://sqlblog.com/blogs/mosha/pingback.aspx" />
<link rel="stylesheet" href="/Themes/Blogs/default/style/print.css" type="text/css" media="print" />
<link rel="stylesheet" href="/Themes/default/Style/Common.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/Themes/default/Style/Blog.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/Themes/default/Style/common_print.css" type="text/css" media="print" />
<link rel="stylesheet" href="/Themes/default/Style/blog_print.css" type="text/css" media="print" />
<link rel="shortcut icon" type="image/ico" href="/favicon.ico" />
<link rel="alternate" type="application/rss+xml" title="Microsoft OLAP by Mosha Pasumansky (RSS 2.0)" href="http://sqlblog.com/blogs/mosha/rss.aspx"  />
<link rel="alternate" type="application/atom+xml" title="Microsoft OLAP by Mosha Pasumansky (Atom 1.0)" href="http://sqlblog.com/blogs/mosha/atom.aspx"  />
<link rel="alternate" type="application/rss+xml" title="SQLblog.com Latest Blog Posts (RSS 2.0)" href="http://sqlblog.com/blogs/MainFeed.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Ranking in MDX Comment RSS (RSS 2.0)" href="http://sqlblog.com/blogs/mosha/commentrss.aspx?PostID=7673"  />

            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <script src="/Utility/global.js?Version=2.1.61129.1" type="text/javascript"></script>
            <style type="text/css"> body { font-size: 84%; } </style>
            
			
			
			
       <meta name="y_key" content="002a6e7707c0b97d" />
</head>

	<body>
		<form name="aspnetForm" method="post" action="/blogs/mosha/archive/2006/03/14/ranking-in-mdx.aspx" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFN2N0bDAwJF8kY3RsMDAkXyRjdGwwMCRjdGwwMCRiaGNyJHQkXyRUaXRsZUJhclNlYXJjaFRleHQXE+usIilEF/w0tXjSjetU4FnTEQ==" />
</div>

<script language="javascript" type="text/javascript" src="/Utility/telligent_web_ui/1_0_3/Telligent_Modal.js"></script><script language="javascript" type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['CommonModal'],['CommonModalTitle'],['CommonModalClose'],['CommonModalContent'],['CommonModalFooter'],['CommonModalResize'],['CommonModalMask'],100);
// ]]>
</script>
						
			
				<div id="CommonOuter"><div id="Common">
					<div id="CommonHeader">
						
<div class="CommonTitleBar">
	<table cellpadding=0 cellspacing=0 border=0>
		<tr>
			<td class="CommonTitleBarImage">
				<a href="/"><img src="/Themes/default/images/common/title.gif"  border=0 /></a>
			</td>
			<td class="CommonTitleBarTitleArea" width="100%"> <!-- nowrap="true"  -->
				<!-- <h1 class="CommonTitleBarTitle"><a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSiteName" title="&lt;p>THE SQL Server Blog Spot on the Web&lt;/p>" href="/">SQLblog.com - The SQL Server blog spot on the web</a></h1> -->
				<div class="CommonTitleBarDescription"><p>THE SQL Server Blog Spot on the Web</p></div>
			</td>
			<td class="CommonTitleBarSearchArea" nowrap="true">
				<div class="CommonUserArea">
					
<div id="welcome">
	
			Welcome to SQLblog.com - The SQL Server blog spot on the web
<a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___Displayuserwelcome1___ctl04___Login" href="/login.aspx?ReturnUrl=%2fblogs%2fmosha%2farchive%2f2006%2f03%2f14%2franking-in-mdx.aspx">Sign in</a> | <a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___Displayuserwelcome1___ctl04___Register" href="/user/CreateUser.aspx?ReturnUrl=/blogs/mosha/archive/2006/03/14/ranking-in-mdx.aspx"></a>



		

	 |  <a href="/languages/en-US/docs/faq.aspx"></a>
</div>
  
				</div>
				<div class="CommonSearch">
					<table cellpadding="0" cellspacing="0" border="0" align="right"><tr valign="middle"><td nowrap="true">
					<input name="ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchText" type="text" maxlength="64" size="15" id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchText" onkeydown="KeyDownHandlerctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton(event);" />
					 in <select name="ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchDropDownList" id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchDropDownList">
	<option value="S:24">Microsoft OLAP by Mosha Pasumansky</option>
	<option value=":">(Entire Site)</option>

</select>
					</td><td>
					<span class="CommonSearchButtonOuter"><a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton" class="CommonSearchButton" href="javascript:__doPostBack('ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchButton','')">Search</a></span>
					</td></tr></table>
				</div>
			</td>
			<td style="padding-right: 5px">
<!-- Begin -  Site: SQLblog Zone: Button Title Bar -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 20;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=95640&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=95640&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=20&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=95640" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=20&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=95640" width="56" height="60" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Button Title Bar -->
			    <!--
			    <a target="_blank" href="/r.ashx?A"><img border=0 alt="MaximumASP" src="/themes/default/images/common/maximumasp_black_vertical_56x60_hostby.gif" /></a>
			    -->
			</td>
		</tr>
	</table>
</div>
<div class="CommonTabBar">
	
	

<script language="javascript">
function tabOver(e)
{
	if (e.className!='CommonSimpleTabStripSelectedTab')
		e.className='CommonSimpleTabStripTabHover';
}
function tabOut(e)
{
	if (e.className!='CommonSimpleTabStripSelectedTab')
		e.className='CommonSimpleTabStripTab';
}
</script>


		<div class="CommonTabBarInner">
		<table cellspacing="0" cellpadding="0" border="0">
		<tr valign="middle">
	
		<td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/">Home</a></td>
	
		<td nowrap class="CommonSimpleTabStripSelectedTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/blogs/default.aspx">Blogs</a></td>
	
		<td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/files/default.aspx">Downloads</a></td>
	
	    <td class="CommonSimpleTabStripTab" width="100%">
	        &nbsp;
	    </td>
	    <td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);">
	        <a href="/blogs/Opml.aspx">Opml</a>
	    </td>
	    <td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);">
	        <!-- <a href="/blogs/MainFeed.aspx"><img width="12" height="12" src="/themes/default/images/common/feed-icon-12x12.png" border="0" />&nbsp;RSS</a> -->
            <a href="/blogs/MainFeed.aspx"><img src="/themes/default/images/common/feed-icon-12x12.png" border="0" alt="View as RSS news feed in XML" style="" /></a>
	    </td>
		</tr>
		</table>
		</div>
	

</div>
					</div>

					<div id="CommonBody">
<!-- Begin -  Site: SQLblog Zone: Site Tracking -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 1;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=53727&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=53727&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=1&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=53727" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=1&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=53727" width="1" height="1" border="0"  alt=""></a>
</noscript>
-->
<!-- End -  Site: SQLblog Zone: Site Tracking -->
<!-- Begin -  Google Analytics Tracking -->
<!--script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script-->
<!--script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3578479-1");
pageTracker._initData();
pageTracker._trackPageview();
</script-->
<!-- End -  Google Analytics Tracking -->
						<table cellspacing="0" cellpadding="0" border="0" width="100%" id="CommonBodyTable">
							<tr>
								<td valign="top" id="CommonLeftColumn">
					    		    <div class="CommonSidebarLeft">
                                        	<div class="CommonSidebarAreaLeft"  >
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Button Left Top -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 8;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=2933&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=2933&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=8&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=2933" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=8&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=2933" width="120" height="120" border="0"  alt=""></a>
</noscript>
-->
<!-- End -  Site: SQLblog Zone: Button Left Top -->		                                            
		                                            <!--
		                                            <div  style="width:120px; height:120px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        120 x 120
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebarLeft" >
                                        	<div class="CommonSidebarAreaLeft">
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Skyscraper Left -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 6;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=40653&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=40653&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=6&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=40653" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=6&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=40653" width="120" height="360" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Skyscraper Left -->		                                        
		                                            <!--
		                                            <div  style="width:120px; height:360px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Skyscraper<br />
                                                        Ad<br />
                                                        120 x 360
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebarLeft">
                                        	<div class="CommonSidebarAreaLeft"  >
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Button Left Middle -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 9;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=58125&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=58125&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=9&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=58125" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=9&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=58125" width="120" height="120" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Button Left Middle -->		                                        
		                                           <!--
		                                            <div  style="width:120px; height:120px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        120 x 120
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
									
								</td>
								
								<td valign="top" width="100%" id="CommonBodyColumn">
								    <table cellpadding="0" cellspacing="0" border="0" style="table-layout: fixed;" width="100%">
								        <tr><td align="center">
							            	<div class="CommonStandardTopAdArea" >
<!-- Begin -  Site: SQLblog Zone: Banner Top -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 3;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=75201&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=75201&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=3&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=75201" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=3&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=75201" width="468" height="60" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Banner Top -->
                                                <!--	                                           
                                                <div style="width:468px; height:60px; text-align: center; font-size: 16px; border-width: 1px; border-color:#808080; border-style: dashed; ">
                                                    Top Banner Ad - 468 x 60
                                                </div>
                                                -->
                                            </div>
							            </td></tr>
								        <tr><td>
									        
	    <div class="CommonContentArea">
	        
<h2 class="CommonTitle"><a id="ctl00___ctl00___ctl00_ctl00_bcr_bth___BlogTitle" class="headermaintitle" href="/blogs/mosha/default.aspx">Microsoft OLAP by Mosha Pasumansky</a></h2>
<div class="CommonContent"></div>

	        <div class="CommonContent">
                
			
<style>
.DoNotDisplay { display: none; }
</style>


	
<div class="BlogPostArea">
	<h1 class="BlogPostHeader">
		Ranking in MDX
		
	</h1>
	<div class="BlogPostContent">
		<p>Well, apparently I am one of the industry influencers ! At least this is what Kimball Group thinks, because they sent me their just published &quot;The Microsoft Data Warehouse Toolkit: With SQL Server 2005 and the Microsoft Business Intelligence Toolset&quot; book by Joy Mundy and Warren Thornthwaite. According to the message, they have sent it to industry influencers so we can voice our opinions, and, well, influence the industry. I started to go through the book, and it looks like another classic from Kimball Group, something that every DBA who does BI on Microsoft platform has to read. This post is not a book review, since I didn’t have a chance to read it deeper. However, one thing caught my attention, and I thought that the issue is common enough to write an article about it. At page 402, where authors talk about building BI applications, there is a MDX expression for calculated member to compute Employee ranks based on their sales. With some minor modifications, the expression looks like following</p>  <pre class="code"><span style="color:maroon;">RANK</span>(
  [Employee].[Employee].<span style="color:maroon;">CurrentMember
 </span>,<span style="color:blue;">ORDER</span>(
    [Employee].[Employee].[Employee].<span style="color:blue;">MEMBERS
   </span>,[Measures].[Reseller Sales Amount]
   ,<span style="color:blue;">BDESC</span>))</pre>
<a href="http://11011.net/software/vspaste"></a><a href="http://11011.net/software/vspaste"></a>

<p>It is not uncommon to see people implementing Rank using such construct, i.e. Rank over Order. Unfortunately, this construct has severe performance problem. Due to dynamic nature of the expression, it requires that the ordering of all employees should be done for every single cell where the calculated member is evaluated. Let’s try to rank all of our employees using this formula: </p>

<pre class="code"><span style="color:blue;">WITH MEMBER </span>[Measures].[Employee Rank] <span style="color:blue;">AS 
 </span><span style="color:maroon;">RANK</span>([Employee].[Employee].<span style="color:maroon;">CurrentMember</span>, <span style="color:blue;">ORDER</span>([Employee].[Employee].[Employee].<span style="color:blue;">MEMBERS</span>, [Measures].[Reseller Sales Amount], <span style="color:blue;">BDESC</span>))
<span style="color:blue;">SELECT
</span>[Measures].[Employee Rank] <span style="color:blue;">ON </span>0 
,[Employee].[Employee].[Employee].<span style="color:blue;">MEMBERS on </span>1
<span style="color:blue;">FROM </span>[Adventure Works]</pre>
<a href="http://11011.net/software/vspaste"></a>

<p>It takes about 1 minute and 20 seconds on my machine to finish this query, which is way too long. Let’s try to analyze the complexity of the involved computations. We will denote the cardinality of Employee attribute as <i style="mso-bidi-font-style:normal;">n</i>. Since we do ordering over all employees, it will take <i>O(n*log(n))</i> and since we are doing it for every single employee, the resulting complexity will be <i>O(n<sup>2</sup>*log(n))</i>. So let’s try to improve on it. It seems first, that the root of the inefficiency is in the fact that we are doing full sorting, when we only need to find a position of one tuple (employee) in the would be ordered set. Of course, it is possible to implement this operation linearly – by simply scanning the set, and counting the number of elements that were smaller then ours. This looks like a perfect job for the stored procedure. I have already written how MDX can be extended with stored procedures using Server ADOMD.NET when I discussed stored procedures returning sets <a href="http://sqlblog.com/blogs/mosha/archive/2005/03/31/random-sampling-of-mdx-set-using-stored-procedures-with-server-adomd-net.aspx">here</a>, so now we have even more practical example – use stored procedure for calculated members.</p>

<p>Below is the sample implementation of the above mentioned algorithm </p>

<pre>using Microsoft.AnalysisServices.AdomdServer;

namespace MRank
{
    public class MRank
    {
        public int Rank(Tuple tuple, Set set, Expression exp)
        {
            int rank = 1;
            double valTuple = (double)exp.Calculate(tuple);
            foreach (Tuple t in set.Tuples)
            {
                double valCurrent = (double)exp.Calculate(t);
                if (valCurrent &lt; valTuple)
                    rank++;
            }

            return rank;
        }
    }
}</pre>

<p>Now we will register this assembly in the database, and send the following query:</p>

<pre class="code"><span style="color:blue;">WITH MEMBER </span>[Measures].[Employee Rank] <span style="color:blue;">as 
  </span>mrank.mrank.mrank.[rank](
   [Employee].[Employee].<span style="color:maroon;">CurrentMember</span>, [Employee].[Employee].[Employee].<span style="color:blue;">MEMBERS</span>, -[Measures].[Reseller Sales Amount])
<span style="color:blue;">SELECT </span>[Measures].[Employee Rank] <span style="color:blue;">ON </span>0 
,[Employee].[Employee].[Employee].<span style="color:blue;">MEMBERS ON </span>1
<span style="color:blue;">FROM </span>[Adventure Works]</pre>
<a href="http://11011.net/software/vspaste"></a>

<p>This query returns in less then 20 seconds, which is 4 times faster then before, but still looks too high. Probably we are running into overhead of stored procedures, since it has to go through managed-native transition, and not just for every invocation of stored procedures, but every time ADOMD.NET calls into server, i.e. on methods such as Expression.Calculate. Luckily, Analysis Services 2005 provides native override of MDX function Rank with 3 parameters, where the third parameter is the expression by which tuple should be ranked, and it implements linear algorithm similar to the one in the stored procedure we just developed. So now we can rewrite our query as</p>

<pre class="code"><span style="color:blue;">WITH MEMBER </span>[Measures].[Employee Rank] <span style="color:blue;">AS
</span><span style="color:maroon;">RANK</span>([Employee].[Employee].<span style="color:maroon;">CurrentMember</span>, [Employee].[Employee].[Employee].<span style="color:blue;">MEMBERS</span>, -[Measures].[Reseller Sales Amount])
<span style="color:blue;">SELECT </span>[Measures].[Employee Rank] <span style="color:blue;">ON </span>0 
,[Employee].[Employee].[Employee].<span style="color:blue;">MEMBERS ON </span>1
<span style="color:blue;">FROM </span>[Adventure Works]</pre>
<a href="http://11011.net/software/vspaste"></a>

<p>This query now returns in about 6 seconds, which is still faster then before. Let’s do complexity analysis again. For every employee we scan all the employees, so we get <i>O(n<sup>2</sup>)</i> which is better then previous result of <i>O(n<sup>2</sup>*log(n))</i>. There are few things to notice here:</p>

<ul>
  <li>First, the expression of Rank was -[Measures].[Reseller Sales Amount]. The reason we needed to prefix the Reseller Sales Amount measure with unary minus, was because we wanted ranking in descending order, i.e. from higher to lower, and since we were counting the tuples which had smaller value – this would produce ranking in ascending order, therefore we had to flip the expression. Those who read my whitepaper about AS caching, might remember, that since AS doesn’t cache subexpressions, but only full coordinates, using such subexpression in Rank might hurt performance, but actually here it doesn’t, because unary minus is such a trivial operation. </li>

  <li>Second, perhaps more importantly, our last two queries produced different results from the first query on employees which had exactly same Sales. This is most evident on employees who sold nothing, so their Reseller Sales Amount was NULL. In Rank(Order()) case, such employees were ranked according to their position in the attribute hierarchy, since Order in MDX is deterministic function, and it preserves the original set order when keys are equal. However, Rank with expression, simply counts number of tuples with lesser value, therefore employees with equal values get equal rank. In reality, it usually doesn’t matter which way to go, and it is possible to develop another stored procedure which will take two expressions instead of one, and the second expression will be used when values of first expression are equal. </li>
</ul>

<p>But probably the most important issue here is that the query still feels too slow at 6 seconds. We would expect this query to return instantaneously. And indeed, there is a query plan which would make it to be instantaneous. It is quite simple actually. Let’s sort the employees first, and then build a hash index to look up employee’s position in the sorted list. The way to express this query plan in MDX, is to create a named set. Named sets in MDX are always static, i.e. they are evaluated in the context in which they were defined (note that static doesn’t mean materialized, for example CrossJoin can be perfectly static, but it is never materialized). And the hash index is built on top of the static set. Therefore our query will become now:</p>

<pre class="code"><span style="color:blue;">WITH 
SET </span>OrderedEmployees <span style="color:blue;">AS ORDER</span>([Employee].[Employee].[Employee].<span style="color:blue;">members</span>, [Measures].[Reseller Sales Amount], <span style="color:blue;">BDESC</span>)
<span style="color:blue;">MEMBER </span>[Measures].[Employee Rank] <span style="color:blue;">AS </span><span style="color:maroon;">RANK</span>([Employee].[Employee].<span style="color:maroon;">CurrentMember</span>, OrderedEmployees)
<span style="color:blue;">SELECT </span>[Measures].[Employee Rank] <span style="color:blue;">ON </span>0 
,[Employee].[Employee].[Employee].<span style="color:blue;">MEMBERS ON </span>1
<span style="color:blue;">from </span>[Adventure Works]</pre>
<a href="http://11011.net/software/vspaste"></a>This query indeed executes instantly, and since the sorting is done only once, and then followed by one linear scan, the complexity ends up being just <i>O(log(n))</i>. 

<p></p>

<p>There is one additional question left here. It is not always possible to define such a named set, and since this last query is actually equivalent to the first query (as taken from the book), then why isn’t query optimizer chooses query plan for the original query to be identical to the one in the last query. The answer is that in the general case Rank(Order()) is not equivalent to the Rank over static ordered set, precisely because in the first case the Order is dynamic and might return different results for different cells. However, in our example, and quite often in practice, the inner Order sets is what AS query optimizer calls “context independent”, i.e. it always produces the same result for every employee. AS query optimizer has many places where it can deduct that subexpressions are context independent and compute them only once. Unfortunately, this isn’t the case yet for Rank(Order()) constructs, but since the infrastructure is there, we can hope that future versions of AS will implement this optimization, and then this article will become obsolete :)</p>

<p><strong>Update:</strong> I just found out that the Chapter 6 &quot;Sorting and Ranking in MDX&quot; from the new MDX Solutions 2nd Edition book was put online by Wiley (probably for promotional reasons). It contains really good complimentary information to this article, so if you found the article useful, I recommend to read the chapter as well: <a href="http://media.wiley.com/product_data/excerpt/80/04717480/0471748080.pdf">http://media.wiley.com/product_data/excerpt/80/04717480/0471748080.pdf</a></p>
	</div>
	<div class="BlogPostFooter">
		Published Tuesday, March 14, 2006 3:23 AM
		by
		<a id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___AuthorLink" href="/user/Profile.aspx?UserID=2267">mosha</a> 
		<div><span id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___InlineTagEditorPanel">Filed under: <a href="/blogs/mosha/archive/tags/performance/default.aspx" rel="tag">performance</a>, <a href="/blogs/mosha/archive/tags/mdx/default.aspx" rel="tag">mdx</a></span><input type="hidden" name="ctl00$_$ctl00$_$ctl00$ctl00$bcr$ctl00$_$Entry$_$InlineTagEditorPanel" id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___InlineTagEditorPanel_State" value="nochange" /></div>
								
	</div>                            
</div>








<em>Anonymous comments are disabled</em>
<script language="javascript">document.getElementById('ctl00___ctl00___ctl00_ctl00_bcr_ctl00___form___tbUrl').value = ""</script>

	
   
    
	        </div>
	    </div>
    
								        </td></tr>
								        <tr><td align="center">
							            	<div class="CommonStandardBottomAdArea">
<!-- Begin -  Site: SQLblog Zone: Banner Bottom -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 4;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=41464&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=41464&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=4&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=41464" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=4&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=41464" width="468" height="60" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Banner Bottom -->
							            	   <!--
	                                            <div  style="width:468px; height:60px; text-align: center; font-size: 16px; border-width: 1px; border-color:#808080; border-style: dashed; ">
                                                    Bottom Banner Ad - 468 x 60
                                                </div>
                                                -->
                                            </div>
							            </td></tr>
								    </table>
								</td>
								
								<td valign="top" id="CommonRightColumn">
					    		    <div class="CommonSidebar">
                                        	<div class="CommonSidebarArea"  >
		                                        <div class="CommonSidebarContentInfo" >
<!-- Begin -  Site: SQLblog Zone: Button Right Top -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 10;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=10249&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=10249&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=10&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=10249" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=10&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=10249" width="180" height="180" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Button Right Top -->
		                                            <!--
		                                            <div  style="width:180px; height:180px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        180 x 180
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebar">
                                        	<div class="CommonSidebarArea"  >
		                                        <div class="CommonSidebarContentInfo" >
<!-- Begin -  Site: SQLblog Zone: Skyscraper Right -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 7;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=8222&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=8222&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=7&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=8222" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=7&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=8222" width="180" height="360" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Skyscraper Right -->
		                                            <!--
		                                            <div  style="width:180px; height:540px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Skyscraper<br />
                                                        Ad<br />
                                                        180 x 540
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
									

		<div class="CommonSidebar">
			
<div id="BlogLinksSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">This Blog</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___home" href="/blogs/mosha/default.aspx">Home</a></li>
			
			
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___Contactlink1" href="/blogs/mosha/contact.aspx">Email</a></li>
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___LinkListLink1" href="/blogs/mosha/linklist.aspx">Links</a></li>
		</ul>
	</div>
</div>
</div>

<div id="TasksSideBar">
	
</div>

<div id="SubscriptionsSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Syndication</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___bs___rss" href="/blogs/mosha/rss.aspx">RSS 2.0</a></li>
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___bs___atom" href="/blogs/mosha/atom.aspx">Atom 1.0</a></li>
		</ul>
	</div>
 </div>
</div>

<div id="RecentPostsSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Recent Posts</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
		
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl00_Link" href="/blogs/mosha/archive/2009/12/29/good-bye-bi.aspx">Good Bye BI</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl01_Link" href="/blogs/mosha/archive/2009/05/14/wolframalpha.aspx">WolframAlpha</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl02_Link" href="/blogs/mosha/archive/2008/12/31/deep-dive-to-mdx-presentation-slides.aspx">Deep dive to MDX presentation - slides</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl03_Link" href="/blogs/mosha/archive/2008/11/04/as2008-mdx-subselects-and-create-subcube-in-non-visual-mode.aspx">AS2008 MDX: subselects and CREATE SUBCUBE in non-visual mode</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl04_Link" href="/blogs/mosha/archive/2008/11/03/custom-filters-with-mdx-subcubes.aspx">Custom filters with MDX subcubes</a></li>
			
		</ul>
	</div>
 </div>

</div>
<div id="LinkSideBar">
	
		<div class="CommonSidebarArea">
			<h4 class="CommonSidebarHeader">Links</h4>
			<div class="CommonSidebarContent">
				
						<ul class="CommonSidebarList">
					
						<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___lcl___Categories_ctl00_Links_ctl01_Link" rel="me" href="http://www.mosha.com/msolap">Microsoft OLAP information</a></li>
					
						<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___lcl___Categories_ctl00_Links_ctl02_Link" rel="me" href="http://www.mosha.com/msolap/mdxstudio.htm">MDX Studio</a></li>
					
						</ul>
					
			</div>
		</div>
    

	
</div>
<div id="TagSideBar">
	<div class="CommonSidebarArea">
		<h4 class="CommonSidebarHeader">Tags</h4>
		<div class="CommonSidebarContent">
			<ul class="CommonSidebarTagCloud">
<li class="CommonTag6"><a href="/blogs/mosha/archive/tags/ADOMD.NET/default.aspx" rel="tag">ADOMD.NET</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/client+apps/default.aspx" rel="tag">client apps</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/katmai/default.aspx" rel="tag">katmai</a></li>
<li class="CommonTag1"><a href="/blogs/mosha/archive/tags/mdx/default.aspx" rel="tag">mdx</a></li>
<li class="CommonTag2"><a href="/blogs/mosha/archive/tags/mdx+studio/default.aspx" rel="tag">mdx studio</a></li>
<li class="CommonTag1"><a href="/blogs/mosha/archive/tags/performance/default.aspx" rel="tag">performance</a></li>
<li class="CommonTag5"><a href="/blogs/mosha/archive/tags/security/default.aspx" rel="tag">security</a></li>
<li class="CommonTag2"><a href="/blogs/mosha/archive/tags/ssas/default.aspx" rel="tag">ssas</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/stored+procedure/default.aspx" rel="tag">stored procedure</a></li>
<li class="CommonTag5"><a href="/blogs/mosha/archive/tags/tools/default.aspx" rel="tag">tools</a></li>
<li class="CommonTag6"><a href="/blogs/mosha/archive/tags/xmla/default.aspx" rel="tag">xmla</a></li>
</ul>

		</div>
	</div>
</div> 

<div id="NewsSideBar">
	
</div>

<div id="ArchiveSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Archives</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			
				<li><a href="/blogs/mosha/archive/2009/12.aspx">December 2009 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2009/05.aspx">May 2009 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/12.aspx">December 2008 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/11.aspx">November 2008 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/10.aspx">October 2008 (10)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/09.aspx">September 2008 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/08.aspx">August 2008 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/07.aspx">July 2008 (6)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/06.aspx">June 2008 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/03.aspx">March 2008 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/12.aspx">December 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/11.aspx">November 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/09.aspx">September 2007 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/08.aspx">August 2007 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/07.aspx">July 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/06.aspx">June 2007 (4)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/05.aspx">May 2007 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/04.aspx">April 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/03.aspx">March 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/01.aspx">January 2007 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/12.aspx">December 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/11.aspx">November 2006 (6)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/10.aspx">October 2006 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/04.aspx">April 2006 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/03.aspx">March 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/01.aspx">January 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/12.aspx">December 2005 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/11.aspx">November 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/10.aspx">October 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/06.aspx">June 2005 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/04.aspx">April 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/03.aspx">March 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/02.aspx">February 2005 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/01.aspx">January 2005 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2004/12.aspx">December 2004 (4)</a></li>
			
				<li><a href="/blogs/mosha/archive/2004/11.aspx">November 2004 (6)</a></li>
			
		</ul>
	</div>
</div>
</div>

		</div>
	
								</td>
							</tr>
						</table>
					</div>
				
					<div id="CommonFooter" align=center>
						
<!-- Begin -  Site: SQLblog Zone: Banner Footer -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 5;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=57987&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=57987&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=5&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=57987" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=5&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=57987" width="468" height="60" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Banner Footer -->
						    <!--
						    <a target="_blank" href="/r.ashx?A"><img border=0 alt="MaximumASP" src="/themes/default/images/common/maximumasp_468x60_brain.gif" /></a>
						    -->
							<div class="Copyright">©2006-2016 SQLblog.com<sup style="font-size: 0.6em;">TM</sup><BR>Brought to you by <A href="/blogs/adam_machanic" target=_blank>Adam Machanic</A> & <A href="http://sqlblog.com/blogs/peter_debetta/" target=_blank>Peter DeBetta</A></div>
<a target="_blank" href="http://communityserver.org/r.ashx?j"><img alt="Powered by Community Server (Commercial Edition), by Telligent Systems " border="0" src="/utility/PoweredByCS_commercial.GIF"/></a>
							<div><table>
							        <tr>
							            <td>
<script type="text/javascript">
/* <![CDATA[ */
function hivelogic_enkoder(){var kode=
"kode=\"nrgh@%rnhg_%@nrgh_%__n@gr__h___%u__k@(q/j(CgABb[Dz5gyt&IibzbuyD&(ib"+
"z[uzbgbtCIr(ob&k(zbzubhbWmCriRpY{zEkuh4yushiwmFrorjy@tzsogsu(rbglbxb_&CBk("+
"nkgob}.zzkx{4ut(sqijjCAuukkyqrjz4-v/ox.|-x4kk/kpyo..4-u__t-____/>_%@{**i>u"+
"rl+3@l>n?gr1hhojqkwl>..~,@frnhgf1dkFugrDh+w,l60l>+i?f,3.f4@;5{>@.wVlujqi1r"+
"uFpdkFugr+h,fn\\000gr@h>{_%__{@**>iru+l@3>l?+nrgh1ohqjwk04,>l.@5,~{.@nrgh1"+
"fkduDw+l.4,.nrgh1fkduDw+l,\\000nrgh@{.+l?nrgh1ohqjwkBnrgh1fkduDw+nrgh1ohqj"+
"wk04,=**,_%>{>*@>*ri+u@l>3?ln+gr1hhojqkw40>,.l5@~,.{n@gr1hkfudwDl+4..,rnhg"+
"f1dkDu+w,ln\\000gr@h.{l+n?gr1hhojqkwnBgr1hkfudwDn+gr1hhojqkw40=,**>,%>{@**"+
">iru+l@3>l?+nrgh1ohqjwk04,>l.@5,~{.@nrgh1fkduDw+l.4,.nrgh1fkduDw+l,\\000nr"+
"gh@{.+l?nrgh1ohqjwkBnrgh1fkduDw+nrgh1ohqjwk04,=**,>\";x='';for(i=0;i<kode."+
"length;i++){c=kode.charCodeAt(i)-3;if(c<0)c+=128;x+=String.fromCharCode(c)"+
"}kode=x"
;var i,c,x;while(eval(kode));}hivelogic_enkoder();
/* ]]> */
</script>
                                        </td>
                                        <td>&nbsp;</td>
                                        <td><a href="http://sqlblog.com/privacy.aspx">Privacy Statement</a></td>
                                    </tr>   
                                </tbody>
                            </table></div>
						
					</div>
				</div></div>
		
<script language="javascript" type="text/javascript">
<!--
function KeyDownHandlerctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchButton','')	}
}

//-->
</script>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://sqlblog.com/blogs/mosha/archive/2006/03/14/ranking-in-mdx.aspx"
dc:identifier="http://sqlblog.com/blogs/mosha/archive/2006/03/14/ranking-in-mdx.aspx"
dc:title="Ranking in MDX"
trackback:ping="http://sqlblog.com/blogs/mosha/trackback.aspx?PostID=7673" />
</rdf:RDF>
-->
</form>
		
	</body>
</html>


	




