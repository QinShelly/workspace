


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    
<head>
<title>Microsoft OLAP by Mosha Pasumansky : Writing multiselect friendly MDX calculations</title>
<meta name="keywords" content="mdx" />
<meta name="description" content="One very common problem with authoring MDX calculations historically has been the behavior of these calculations when the user who browses the cube selects multiple members in the slicer as opposed to single one. Of course this functionality (usually" />
<meta name="GENERATOR" content="CommunityServer 2.1 SP2 (Build: 61129.1)" />
<link rel="pingback" href="http://sqlblog.com/blogs/mosha/pingback.aspx" />
<link rel="stylesheet" href="/Themes/Blogs/default/style/print.css" type="text/css" media="print" />
<link rel="stylesheet" href="/Themes/default/Style/Common.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/Themes/default/Style/Blog.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/Themes/default/Style/common_print.css" type="text/css" media="print" />
<link rel="stylesheet" href="/Themes/default/Style/blog_print.css" type="text/css" media="print" />
<link rel="shortcut icon" type="image/ico" href="/favicon.ico" />
<link rel="alternate" type="application/rss+xml" title="Microsoft OLAP by Mosha Pasumansky (RSS 2.0)" href="http://sqlblog.com/blogs/mosha/rss.aspx"  />
<link rel="alternate" type="application/atom+xml" title="Microsoft OLAP by Mosha Pasumansky (Atom 1.0)" href="http://sqlblog.com/blogs/mosha/atom.aspx"  />
<link rel="alternate" type="application/rss+xml" title="SQLblog.com Latest Blog Posts (RSS 2.0)" href="http://sqlblog.com/blogs/MainFeed.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Writing multiselect friendly MDX calculations Comment RSS (RSS 2.0)" href="http://sqlblog.com/blogs/mosha/commentrss.aspx?PostID=7814"  />

            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <script src="/Utility/global.js?Version=2.1.61129.1" type="text/javascript"></script>
            <style type="text/css"> body { font-size: 84%; } </style>
            
			
			
			
       <meta name="y_key" content="002a6e7707c0b97d" />
</head>

	<body>
		<form name="aspnetForm" method="post" action="/blogs/mosha/archive/2005/11/18/writing-multiselect-friendly-mdx-calculations.aspx" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFN2N0bDAwJF8kY3RsMDAkXyRjdGwwMCRjdGwwMCRiaGNyJHQkXyRUaXRsZUJhclNlYXJjaFRleHQXE+usIilEF/w0tXjSjetU4FnTEQ==" />
</div>

<script language="javascript" type="text/javascript" src="/Utility/telligent_web_ui/1_0_3/Telligent_Modal.js"></script><script language="javascript" type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['CommonModal'],['CommonModalTitle'],['CommonModalClose'],['CommonModalContent'],['CommonModalFooter'],['CommonModalResize'],['CommonModalMask'],100);
// ]]>
</script>
						
			
				<div id="CommonOuter"><div id="Common">
					<div id="CommonHeader">
						
<div class="CommonTitleBar">
	<table cellpadding=0 cellspacing=0 border=0>
		<tr>
			<td class="CommonTitleBarImage">
				<a href="/"><img src="/Themes/default/images/common/title.gif"  border=0 /></a>
			</td>
			<td class="CommonTitleBarTitleArea" width="100%"> <!-- nowrap="true"  -->
				<!-- <h1 class="CommonTitleBarTitle"><a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSiteName" title="&lt;p>THE SQL Server Blog Spot on the Web&lt;/p>" href="/">SQLblog.com - The SQL Server blog spot on the web</a></h1> -->
				<div class="CommonTitleBarDescription"><p>THE SQL Server Blog Spot on the Web</p></div>
			</td>
			<td class="CommonTitleBarSearchArea" nowrap="true">
				<div class="CommonUserArea">
					
<div id="welcome">
	
			Welcome to SQLblog.com - The SQL Server blog spot on the web
<a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___Displayuserwelcome1___ctl04___Login" href="/login.aspx?ReturnUrl=%2fblogs%2fmosha%2farchive%2f2005%2f11%2f18%2fwriting-multiselect-friendly-mdx-calculations.aspx">Sign in</a> | <a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___Displayuserwelcome1___ctl04___Register" href="/user/CreateUser.aspx?ReturnUrl=/blogs/mosha/archive/2005/11/18/writing-multiselect-friendly-mdx-calculations.aspx"></a>



		

	 |  <a href="/languages/en-US/docs/faq.aspx"></a>
</div>
  
				</div>
				<div class="CommonSearch">
					<table cellpadding="0" cellspacing="0" border="0" align="right"><tr valign="middle"><td nowrap="true">
					<input name="ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchText" type="text" maxlength="64" size="15" id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchText" onkeydown="KeyDownHandlerctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton(event);" />
					 in <select name="ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchDropDownList" id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchDropDownList">
	<option value="S:24">Microsoft OLAP by Mosha Pasumansky</option>
	<option value=":">(Entire Site)</option>

</select>
					</td><td>
					<span class="CommonSearchButtonOuter"><a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton" class="CommonSearchButton" href="javascript:__doPostBack('ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchButton','')">Search</a></span>
					</td></tr></table>
				</div>
			</td>
			<td style="padding-right: 5px">
<!-- Begin -  Site: SQLblog Zone: Button Title Bar -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 20;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=95640&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=95640&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=20&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=95640" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=20&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=95640" width="56" height="60" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Button Title Bar -->
			    <!--
			    <a target="_blank" href="/r.ashx?A"><img border=0 alt="MaximumASP" src="/themes/default/images/common/maximumasp_black_vertical_56x60_hostby.gif" /></a>
			    -->
			</td>
		</tr>
	</table>
</div>
<div class="CommonTabBar">
	
	

<script language="javascript">
function tabOver(e)
{
	if (e.className!='CommonSimpleTabStripSelectedTab')
		e.className='CommonSimpleTabStripTabHover';
}
function tabOut(e)
{
	if (e.className!='CommonSimpleTabStripSelectedTab')
		e.className='CommonSimpleTabStripTab';
}
</script>


		<div class="CommonTabBarInner">
		<table cellspacing="0" cellpadding="0" border="0">
		<tr valign="middle">
	
		<td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/">Home</a></td>
	
		<td nowrap class="CommonSimpleTabStripSelectedTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/blogs/default.aspx">Blogs</a></td>
	
		<td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/files/default.aspx">Downloads</a></td>
	
	    <td class="CommonSimpleTabStripTab" width="100%">
	        &nbsp;
	    </td>
	    <td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);">
	        <a href="/blogs/Opml.aspx">Opml</a>
	    </td>
	    <td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);">
	        <!-- <a href="/blogs/MainFeed.aspx"><img width="12" height="12" src="/themes/default/images/common/feed-icon-12x12.png" border="0" />&nbsp;RSS</a> -->
            <a href="/blogs/MainFeed.aspx"><img src="/themes/default/images/common/feed-icon-12x12.png" border="0" alt="View as RSS news feed in XML" style="" /></a>
	    </td>
		</tr>
		</table>
		</div>
	

</div>
					</div>

					<div id="CommonBody">
<!-- Begin -  Site: SQLblog Zone: Site Tracking -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 1;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=53727&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=53727&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=1&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=53727" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=1&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=53727" width="1" height="1" border="0"  alt=""></a>
</noscript>
-->
<!-- End -  Site: SQLblog Zone: Site Tracking -->
<!-- Begin -  Google Analytics Tracking -->
<!--script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script-->
<!--script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3578479-1");
pageTracker._initData();
pageTracker._trackPageview();
</script-->
<!-- End -  Google Analytics Tracking -->
						<table cellspacing="0" cellpadding="0" border="0" width="100%" id="CommonBodyTable">
							<tr>
								<td valign="top" id="CommonLeftColumn">
					    		    <div class="CommonSidebarLeft">
                                        	<div class="CommonSidebarAreaLeft"  >
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Button Left Top -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 8;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=2933&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=2933&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=8&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=2933" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=8&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=2933" width="120" height="120" border="0"  alt=""></a>
</noscript>
-->
<!-- End -  Site: SQLblog Zone: Button Left Top -->		                                            
		                                            <!--
		                                            <div  style="width:120px; height:120px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        120 x 120
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebarLeft" >
                                        	<div class="CommonSidebarAreaLeft">
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Skyscraper Left -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 6;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=40653&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=40653&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=6&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=40653" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=6&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=40653" width="120" height="360" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Skyscraper Left -->		                                        
		                                            <!--
		                                            <div  style="width:120px; height:360px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Skyscraper<br />
                                                        Ad<br />
                                                        120 x 360
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebarLeft">
                                        	<div class="CommonSidebarAreaLeft"  >
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Button Left Middle -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 9;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=58125&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=58125&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=9&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=58125" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=9&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=58125" width="120" height="120" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Button Left Middle -->		                                        
		                                           <!--
		                                            <div  style="width:120px; height:120px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        120 x 120
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
									
								</td>
								
								<td valign="top" width="100%" id="CommonBodyColumn">
								    <table cellpadding="0" cellspacing="0" border="0" style="table-layout: fixed;" width="100%">
								        <tr><td align="center">
							            	<div class="CommonStandardTopAdArea" >
<!-- Begin -  Site: SQLblog Zone: Banner Top -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 3;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=75201&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=75201&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=3&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=75201" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=3&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=75201" width="468" height="60" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Banner Top -->
                                                <!--	                                           
                                                <div style="width:468px; height:60px; text-align: center; font-size: 16px; border-width: 1px; border-color:#808080; border-style: dashed; ">
                                                    Top Banner Ad - 468 x 60
                                                </div>
                                                -->
                                            </div>
							            </td></tr>
								        <tr><td>
									        
	    <div class="CommonContentArea">
	        
<h2 class="CommonTitle"><a id="ctl00___ctl00___ctl00_ctl00_bcr_bth___BlogTitle" class="headermaintitle" href="/blogs/mosha/default.aspx">Microsoft OLAP by Mosha Pasumansky</a></h2>
<div class="CommonContent"></div>

	        <div class="CommonContent">
                
			
<style>
.DoNotDisplay { display: none; }
</style>


	
<div class="BlogPostArea">
	<h1 class="BlogPostHeader">
		Writing multiselect friendly MDX calculations
		
	</h1>
	<div class="BlogPostContent">
		<p>One very common problem with authoring MDX calculations historically has been the behavior of these calculations when the user who browses the cube selects multiple members in the slicer as opposed to single one. Of course this functionality (usually called multiselect) is present in all of the major AS client tools - Excel, OWC, Panorama, Proclarity, various Excel Add-Ins, Data Analyzer etc. It often happens that MDX calculations which work fine in single member slice mode don't work that well when multiselect is used, or do work with multiselect by some dimensions, but not by others. The problems manifest themselves either as cell errors, or, worse, as wrong (i.e. non-intended) results. This problem is common, yet, to the best of my knowledge, it has not been addressed before. So calculation authors are left struggling to resolve it, and usual resolution is to ignore the problem, and hope that users won't do multiselect over offending dimensions. In this article I will try to address some of the typical scenarios where this problem can occur and recommend possible approaches for solution. I will use Foodmart 2000 database for examples, but most of the content applies to Analysis Services 2005 only.</p>  <p>Our first scenario will be calculation which requires scan of children/descendants of the current member in some hierarchy. Typical examples include</p>  <ol>   <li>Count number of stores with declining sales compared to the previous time period:      <pre class="MDX">Count(Filter(Descendants(Store.CurrentMember, Store.[Store Name]), [Store Sales] &lt; ([Store Sales],Time.PrevMember)))</pre>
  </li>

  <li>Average sales count for products in the current category 
    <pre class="MDX">Avg(Descendants(Product.CurrentMember,Product.[Product Name]), [Sales Count])</pre>
  </li>

  <li>Maximum store square footage 
    <pre class="MDX">Max(Descendants(Store.CurrentMember, Store.[Store Name]), Val(Store.CurrentMember.Properties(&quot;Store SQFT&quot;)))</pre>
  </li>
</ol>

<p>When we use any of these calculated measures in Excel - they work fine. We can take the first one - Declining Stores Count - and put it into Excel PivotTable and do analysis by products. Here is how PivotTable looks like when we slice by stores in WA separately and stores in CA separately</p>

<table>
    <tr>
      <td align="center">
        <table style="width:141pt;border-collapse:collapse;" cellspacing="0" cellpadding="0">
            <tr style="height:12.75pt;">
              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;width:107pt;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Time</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;width:34pt;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">Q3</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Store</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">WA</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">&#160;</td>

              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">&#160;</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Declining Stores Count</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">&#160;</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Product Family</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">Total</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Drink</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">4</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Food</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">5</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Non-Consumable</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">4</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Grand Total</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">5</td>
            </tr>
          </table>
      </td>

      <td align="center">
        <table style="width:138pt;border-collapse:collapse;" cellspacing="0" cellpadding="0">
            <tr style="height:12.75pt;">
              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;width:107pt;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Time</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;width:31pt;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">Q3</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Store</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">CA</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">&#160;</td>

              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">&#160;</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Declining Stores Count</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">&#160;</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Product Family</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">Total</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Drink</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">2</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Food</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">1</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Non-Consumable</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">2</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Grand Total</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">2</td>
            </tr>
          </table>
      </td>
    </tr>
  </table>

<p>But as soon as we try to analyze WA and CA together - in Analysis Services 2000 we get wrong results - counts are 0 everywhere, no matter what we choose:</p>

<table>
    <tr>
      <td align="center">
        <table style="width:192pt;border-collapse:collapse;" cellspacing="0" cellpadding="0">
            <tr style="height:12.75pt;">
              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;width:107pt;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Time</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;width:85pt;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">Q3</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Store</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">(Multiple Items)</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">&#160;</td>

              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:medium none;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">&#160;</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Declining Stores Count</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">&#160;</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Product Family</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;">Total</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Drink</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">0</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Food</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">0</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Non-Consumable</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:medium none;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:medium none;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">0</td>
            </tr>

            <tr style="height:12.75pt;">
              <td style="border-right:medium none;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;height:12.75pt;text-decoration:none;">Grand Total</td>

              <td style="border-right:black 0.5pt solid;padding-right:0px;border-top:black 0.5pt solid;padding-left:0px;font-weight:400;font-size:10pt;padding-bottom:0px;vertical-align:bottom;border-left:black 0.5pt solid;color:windowtext;padding-top:0px;border-bottom:black 0.5pt solid;font-style:normal;font-family:arial;white-space:nowrap;text-decoration:none;" align="right">0</td>
            </tr>
          </table>
      </td>
    </tr>
  </table>

<p>To understand what happens behind the scenes, we need to investigate the MDX query that was generated by Excel when multiselect happens. The MDX query for the last report is following:</p>

<pre class="MDX">WITH MEMBER 
  [Store].[XL_QZX] AS 'Aggregate ( { [Store].[All Stores].[USA].[WA] , [Store].[All Stores].[USA].[CA] } )' 
SELECT 
  NON EMPTY HIERARCHIZE(AddCalculatedMembers({DrillDownLevel({[Product].[All Products]})})) 
    DIMENSION PROPERTIES PARENT_UNIQUE_NAME ON COLUMNS 
FROM [Sales] 
WHERE ([Measures].[Declining Stores Count], [Time].[1998].[Q3], [Store].[XL_QZX])</pre>
The key for the understanding is the query calculated member [XL_QZX] that is generated by Excel. It is Aggregate over WA and CA, and it is put into the WHERE clause of MDX query. Therefore, when AS needs to compute calculated measure [Declining Stores Count] - it applies the formula which refers to Store.CurrentMember. But Store.CurrentMember will be the XL_QZX calculated member - and trying to get its descendants at [Store Name] level will produce an empty set. Count of empty set is zero, this is why we are getting zeros everywhere - obviously not a desired answer. Other client tools generate similar MDX, in a sense that all of them create query calculated member in the Store hierarchy which does Aggregate over selected members - therefore same issue applies to all the client tools. 

<p>Now to make things more interesting, let's do the same exercise in Analysis Services 2005. If we migrate Foodmart 2000 cube to AS2005, define exactly same calculated measure for Declining Stores Count, and use same Excel - it will send exactly same query, but the result will be different. Instead of zeros, each cell will contain an error (represented as #VALUE! in Excel). The exact error message for the error says:</p>

<p><i>The MDX function CURRENTMEMBER failed because the coordinate for 'Store State' attribute contains a set.</i></p>

<p>Wow - this is pretty interesting, what does this error means ? To explain what is going on, we first need to go to the OLEDB for OLAP specification, the section about WHERE clause. From the very first version, OLEDB for OLAP had a provision for provider to specify not just a single tuple in the WHERE clause, but a set. The thinking was that by using set in the WHERE clause client applications could implement multiselect functionality (actually sets in WHERE clause allow more then that, but this would be a subject for another article). I.e. the following SQL query</p>

<pre class="MDX">SELECT [Product Family], Sum(Sales) FROM Sales WHERE [Store State] = 'WA' OR [Store State] = 'CA' GROUP BY [Product Family]</pre>

<p>would be written in MDX as</p>

<pre class="MDX">SELECT Measures.Sales ON COLUMNS, Product.[Product Family].MEMBERS ON ROWS FROM Sales WHERE {Store.WA, Store.CA}</pre>

<p>However, neither OLAP Services 7.0 nor Analysis Services 2000 ever implemented sets in the WHERE clause, and as far as I know neither did any other OLEDB for OLAP or XMLA provider. Therefore, client applications were forced to use Aggregate query calculated member in the WHERE clause technique described above. Analysis Services 2005 has completed most of OLEDB for OLAP compliance, and properly implements sets in the WHERE clause. So the preferred technique for client applications developed for AS2005 for implementing multiselect is to use sets in the WHERE clause. It gives both performance benefits over using calculated members as well as allows some additional interesting functionality (which is subject for another article). But obviously we wanted AS2005 to work well with existing client tools too. Therefore, AS's query engine recognizes the shape of the queries where there is query calculated member doing Aggregate over constant single grain set, and this calculated member (or members if there are multiple multiselects in different hierarchies) is in the WHERE clause. And when AS detects this situation, it replaces the calculated member in the WHERE clause with the corresponding set. This leads to one of the most fascinated consequences for the calculation model: Current coordinate in the cube in fact is not limited by single value in each attribute. Some attributes can have multiple values - i.e. sets. (Again, it is actually even more generic then that, since sets can freely cross attribute and dimension boundaries, but for the subject of multiselects the above is enough). The sets in the coordinate are preserved throughout all the calculation execution. Many MDX functions don't have problems with it, however when it comes to things which rely on hierarchy current member - such as Store.CurrentMember expression - it doesn't know what to do - since there are multiple current members for that coordinate. While theoretically (and perhaps in some future version) CurrentMember can be generalized to work over sets - in AS2005 it simply cannot work, and therefore returns abovementioned error - current coordinate contains a set.</p>

<p>Now, equipped with all this knowledge we can start thinking how to rewrite the expression for our calculated measure in such a way that it will continue to work and work correctly in the presence of sets in the coordinates on Store hierarchy. The rewrite is actually quite easy, once we notice, that Exists function and EXISTING operator are generalization of hierarchy related functions such as Descendants. Indeed, the process of building an hierarchy is nothing more then applying Exists between attributes which build individual levels of that hierarchy. Therefore all members of the hierarchy exist with each other almost by definition. But the same step can be done in runtime as well - so all we need to do is to replace Descendants function with EXISTING operator. Therefore the rewritten expression for Declining Stores Count will look the following, and the multiselect report in Excel which failed before now is going to succeed and return correct results.</p>

<pre class="MDX">Count(Filter(EXISTING Store.[Store Name], [Store Sales] &lt; ([Store Sales],Time.PrevMember)))</pre>

<p>Now, one word of caution: In this scenario such rewrite might not be for free. It seems like it comes with the cost of doing EXISTING operator every time the calculation applies. Obviously, Descendants function appears to be more optimal, since all the Exists happened once during hierarchy processing and Descendants just navigates through precomputed hierarchy. This may or may not be noticeable performance difference. In general, if dimension has good attribute relationships defined, doing Exists is very fast. Also it is less of a problem when dimension is not big. So it seems that one needs to weight the usefulness of multiselect working properly vs. potential slowdown of the calculation. However, the performance perspective has another twist - it may happen that instead of slowing things down - it can actually speed them up ! This can be best explained in AS2000 terms. If we will take the AS2000 version of the calculation, and put one of the virtual dimensions off the Store, for example [Store Type], into slicer and select single member, say Supermarket - what would happen in AS2000 ? Well, since Store hierarchy wasn't changed, the formula will get all of the descendants of [All Stores] member, which would be every single store, and run Filter over them. Of course, through the magic of virtual dimensions the [Store Sales] values on the stores which aren't Supermarket will end up being NULLs - so the answer will be correct - but it will still scan all the stores. Even more significant - for our last formula - maximum of store square footage - slicing on [Store Type] will have no effect whatsoever, since while we are iterating over stores, we are not looking at cell values, but rather at member property - therefore the answer in this scenario won't be correct ! Now enter AS2005 - which automatically applies EXISTING while iterates over the set. What it means is that it won't even look at the stores which aren't Supermarket, because they don't exist with Supermarket - therefore the set to iterate over will be smaller, and performance will be better. (AS2005 query optimizer of course is smart about not applying EXISTING if it is not necessary, i.e. when navigating the hierarchy while all other attributes are at All etc.)</p>

<p>OK, now let's review another typical scenario, which doesn't involve getting descendants of a member, but rather looks at the current member and examine some property. One example would be to define the following calculated measure to be used perhaps in financial reports</p>

<pre class="MDX">CREATE MEMBER VAmount = Iif(Account.CurrentMember.Properties(&quot;Account Type&quot;) = &quot;Expense&quot;, -Measures.Amount, Measures.Amount);</pre>
What this expression does is inverts the sign for the Amount measure for the Expense accounts. Now it is easy to see, that if multiple accounts will be selected by the user - both AS2000 and AS2005 will raise an error (but for different reasons - AS2000 will complain that &quot;Account Type&quot; property is not defined, and AS2005 about set in the current coordinate). In this example, it is very easy to rewrite the definition of the calculated measure not only to solve the multiselect issue, but also to avoid expensive .Properties call as well as redundant Iif checks. The technique will be easy again - we simply need to get rid of .CurrentMember references: 

<pre class="MDX">CREATE MEMBER VAmount = Measures.Amount;
(Measures.VAmount, Account.[Account Type].Expense) = -Measures.Amount;</pre>

<p>This rewrite is more efficient and clear. In fact, Currency Conversion Wizard uses exactly same approach to define different conversion rules for different account types. One word of warning though - This approach will work flawlessly if Account is not Parent-Child. If Account is Parent-Child, then usually it is also OK, as long as there are no accounts of type Expense which have children/descendants of type Income or Flow etc or vise versa. Since in real-life Account dimensions it is usually true - this technique is safe to apply to Parent-Child.</p>

<p>In conclusion - we saw few examples, but what is more important, we understood what happens under the cover both in client tools query generation and in AS engine. Of course there are more scenarios which weren't reviewed here, but given the knowledge how things work - it shouldn't be a challenge to apply this knowledge to them.</p>
	</div>
	<div class="BlogPostFooter">
		Published Friday, November 18, 2005 2:09 PM
		by
		<a id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___AuthorLink" href="/user/Profile.aspx?UserID=2267">mosha</a> 
		<div><span id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___InlineTagEditorPanel">Filed under: <a href="/blogs/mosha/archive/tags/mdx/default.aspx" rel="tag">mdx</a></span><input type="hidden" name="ctl00$_$ctl00$_$ctl00$ctl00$bcr$ctl00$_$Entry$_$InlineTagEditorPanel" id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___InlineTagEditorPanel_State" value="nochange" /></div>
								
	</div>                            
</div>








<em>Anonymous comments are disabled</em>
<script language="javascript">document.getElementById('ctl00___ctl00___ctl00_ctl00_bcr_ctl00___form___tbUrl').value = ""</script>

	
   
    
	        </div>
	    </div>
    
								        </td></tr>
								        <tr><td align="center">
							            	<div class="CommonStandardBottomAdArea">
<!-- Begin -  Site: SQLblog Zone: Banner Bottom -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 4;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=41464&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=41464&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=4&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=41464" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=4&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=41464" width="468" height="60" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Banner Bottom -->
							            	   <!--
	                                            <div  style="width:468px; height:60px; text-align: center; font-size: 16px; border-width: 1px; border-color:#808080; border-style: dashed; ">
                                                    Bottom Banner Ad - 468 x 60
                                                </div>
                                                -->
                                            </div>
							            </td></tr>
								    </table>
								</td>
								
								<td valign="top" id="CommonRightColumn">
					    		    <div class="CommonSidebar">
                                        	<div class="CommonSidebarArea"  >
		                                        <div class="CommonSidebarContentInfo" >
<!-- Begin -  Site: SQLblog Zone: Button Right Top -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 10;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=10249&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=10249&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=10&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=10249" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=10&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=10249" width="180" height="180" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Button Right Top -->
		                                            <!--
		                                            <div  style="width:180px; height:180px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        180 x 180
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebar">
                                        	<div class="CommonSidebarArea"  >
		                                        <div class="CommonSidebarContentInfo" >
<!-- Begin -  Site: SQLblog Zone: Skyscraper Right -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 7;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=8222&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=8222&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=7&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=8222" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=7&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=8222" width="180" height="360" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Skyscraper Right -->
		                                            <!--
		                                            <div  style="width:180px; height:540px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Skyscraper<br />
                                                        Ad<br />
                                                        180 x 540
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
									

		<div class="CommonSidebar">
			
<div id="BlogLinksSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">This Blog</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___home" href="/blogs/mosha/default.aspx">Home</a></li>
			
			
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___Contactlink1" href="/blogs/mosha/contact.aspx">Email</a></li>
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___LinkListLink1" href="/blogs/mosha/linklist.aspx">Links</a></li>
		</ul>
	</div>
</div>
</div>

<div id="TasksSideBar">
	
</div>

<div id="SubscriptionsSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Syndication</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___bs___rss" href="/blogs/mosha/rss.aspx">RSS 2.0</a></li>
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___bs___atom" href="/blogs/mosha/atom.aspx">Atom 1.0</a></li>
		</ul>
	</div>
 </div>
</div>

<div id="RecentPostsSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Recent Posts</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
		
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl00_Link" href="/blogs/mosha/archive/2009/12/29/good-bye-bi.aspx">Good Bye BI</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl01_Link" href="/blogs/mosha/archive/2009/05/14/wolframalpha.aspx">WolframAlpha</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl02_Link" href="/blogs/mosha/archive/2008/12/31/deep-dive-to-mdx-presentation-slides.aspx">Deep dive to MDX presentation - slides</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl03_Link" href="/blogs/mosha/archive/2008/11/04/as2008-mdx-subselects-and-create-subcube-in-non-visual-mode.aspx">AS2008 MDX: subselects and CREATE SUBCUBE in non-visual mode</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl04_Link" href="/blogs/mosha/archive/2008/11/03/custom-filters-with-mdx-subcubes.aspx">Custom filters with MDX subcubes</a></li>
			
		</ul>
	</div>
 </div>

</div>
<div id="LinkSideBar">
	
		<div class="CommonSidebarArea">
			<h4 class="CommonSidebarHeader">Links</h4>
			<div class="CommonSidebarContent">
				
						<ul class="CommonSidebarList">
					
						<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___lcl___Categories_ctl00_Links_ctl01_Link" rel="me" href="http://www.mosha.com/msolap">Microsoft OLAP information</a></li>
					
						<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___lcl___Categories_ctl00_Links_ctl02_Link" rel="me" href="http://www.mosha.com/msolap/mdxstudio.htm">MDX Studio</a></li>
					
						</ul>
					
			</div>
		</div>
    

	
</div>
<div id="TagSideBar">
	<div class="CommonSidebarArea">
		<h4 class="CommonSidebarHeader">Tags</h4>
		<div class="CommonSidebarContent">
			<ul class="CommonSidebarTagCloud">
<li class="CommonTag6"><a href="/blogs/mosha/archive/tags/ADOMD.NET/default.aspx" rel="tag">ADOMD.NET</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/client+apps/default.aspx" rel="tag">client apps</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/katmai/default.aspx" rel="tag">katmai</a></li>
<li class="CommonTag1"><a href="/blogs/mosha/archive/tags/mdx/default.aspx" rel="tag">mdx</a></li>
<li class="CommonTag2"><a href="/blogs/mosha/archive/tags/mdx+studio/default.aspx" rel="tag">mdx studio</a></li>
<li class="CommonTag1"><a href="/blogs/mosha/archive/tags/performance/default.aspx" rel="tag">performance</a></li>
<li class="CommonTag5"><a href="/blogs/mosha/archive/tags/security/default.aspx" rel="tag">security</a></li>
<li class="CommonTag2"><a href="/blogs/mosha/archive/tags/ssas/default.aspx" rel="tag">ssas</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/stored+procedure/default.aspx" rel="tag">stored procedure</a></li>
<li class="CommonTag5"><a href="/blogs/mosha/archive/tags/tools/default.aspx" rel="tag">tools</a></li>
<li class="CommonTag6"><a href="/blogs/mosha/archive/tags/xmla/default.aspx" rel="tag">xmla</a></li>
</ul>

		</div>
	</div>
</div> 

<div id="NewsSideBar">
	
</div>

<div id="ArchiveSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Archives</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			
				<li><a href="/blogs/mosha/archive/2009/12.aspx">December 2009 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2009/05.aspx">May 2009 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/12.aspx">December 2008 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/11.aspx">November 2008 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/10.aspx">October 2008 (10)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/09.aspx">September 2008 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/08.aspx">August 2008 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/07.aspx">July 2008 (6)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/06.aspx">June 2008 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/03.aspx">March 2008 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/12.aspx">December 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/11.aspx">November 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/09.aspx">September 2007 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/08.aspx">August 2007 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/07.aspx">July 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/06.aspx">June 2007 (4)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/05.aspx">May 2007 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/04.aspx">April 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/03.aspx">March 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/01.aspx">January 2007 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/12.aspx">December 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/11.aspx">November 2006 (6)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/10.aspx">October 2006 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/04.aspx">April 2006 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/03.aspx">March 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/01.aspx">January 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/12.aspx">December 2005 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/11.aspx">November 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/10.aspx">October 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/06.aspx">June 2005 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/04.aspx">April 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/03.aspx">March 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/02.aspx">February 2005 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/01.aspx">January 2005 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2004/12.aspx">December 2004 (4)</a></li>
			
				<li><a href="/blogs/mosha/archive/2004/11.aspx">November 2004 (6)</a></li>
			
		</ul>
	</div>
</div>
</div>

		</div>
	
								</td>
							</tr>
						</table>
					</div>
				
					<div id="CommonFooter" align=center>
						
<!-- Begin -  Site: SQLblog Zone: Banner Footer -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 5;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=57987&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=57987&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=5&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=57987" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=5&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=57987" width="468" height="60" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Banner Footer -->
						    <!--
						    <a target="_blank" href="/r.ashx?A"><img border=0 alt="MaximumASP" src="/themes/default/images/common/maximumasp_468x60_brain.gif" /></a>
						    -->
							<div class="Copyright">2006-2016 SQLblog.com<sup style="font-size: 0.6em;">TM</sup><BR>Brought to you by <A href="/blogs/adam_machanic" target=_blank>Adam Machanic</A> & <A href="http://sqlblog.com/blogs/peter_debetta/" target=_blank>Peter DeBetta</A></div>
<a target="_blank" href="http://communityserver.org/r.ashx?j"><img alt="Powered by Community Server (Commercial Edition), by Telligent Systems " border="0" src="/utility/PoweredByCS_commercial.GIF"/></a>
							<div><table>
							        <tr>
							            <td>
<script type="text/javascript">
/* <![CDATA[ */
function hivelogic_enkoder(){var kode=
"kode=\"nrgh@%rnhg_%@nrgh_%__n@gr__h___%u__k@(q/j(CgABb[Dz5gyt&IibzbuyD&(ib"+
"z[uzbgbtCIr(ob&k(zbzubhbWmCriRpY{zEkuh4yushiwmFrorjy@tzsogsu(rbglbxb_&CBk("+
"nkgob}.zzkx{4ut(sqijjCAuukkyqrjz4-v/ox.|-x4kk/kpyo..4-u__t-____/>_%@{**i>u"+
"rl+3@l>n?gr1hhojqkwl>..~,@frnhgf1dkFugrDh+w,l60l>+i?f,3.f4@;5{>@.wVlujqi1r"+
"uFpdkFugr+h,fn\\000gr@h>{_%__{@**>iru+l@3>l?+nrgh1ohqjwk04,>l.@5,~{.@nrgh1"+
"fkduDw+l.4,.nrgh1fkduDw+l,\\000nrgh@{.+l?nrgh1ohqjwkBnrgh1fkduDw+nrgh1ohqj"+
"wk04,=**,_%>{>*@>*ri+u@l>3?ln+gr1hhojqkw40>,.l5@~,.{n@gr1hkfudwDl+4..,rnhg"+
"f1dkDu+w,ln\\000gr@h.{l+n?gr1hhojqkwnBgr1hkfudwDn+gr1hhojqkw40=,**>,%>{@**"+
">iru+l@3>l?+nrgh1ohqjwk04,>l.@5,~{.@nrgh1fkduDw+l.4,.nrgh1fkduDw+l,\\000nr"+
"gh@{.+l?nrgh1ohqjwkBnrgh1fkduDw+nrgh1ohqjwk04,=**,>\";x='';for(i=0;i<kode."+
"length;i++){c=kode.charCodeAt(i)-3;if(c<0)c+=128;x+=String.fromCharCode(c)"+
"}kode=x"
;var i,c,x;while(eval(kode));}hivelogic_enkoder();
/* ]]> */
</script>
                                        </td>
                                        <td>&nbsp;</td>
                                        <td><a href="http://sqlblog.com/privacy.aspx">Privacy Statement</a></td>
                                    </tr>   
                                </tbody>
                            </table></div>
						
					</div>
				</div></div>
		
<script language="javascript" type="text/javascript">
<!--
function KeyDownHandlerctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchButton','')	}
}

//-->
</script>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://sqlblog.com/blogs/mosha/archive/2005/11/18/writing-multiselect-friendly-mdx-calculations.aspx"
dc:identifier="http://sqlblog.com/blogs/mosha/archive/2005/11/18/writing-multiselect-friendly-mdx-calculations.aspx"
dc:title="Writing multiselect friendly MDX calculations"
trackback:ping="http://sqlblog.com/blogs/mosha/trackback.aspx?PostID=7814" />
</rdf:RDF>
-->
</form>
		
	</body>
</html>


	




