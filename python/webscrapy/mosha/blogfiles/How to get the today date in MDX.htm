


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    
<head>
<title>Microsoft OLAP by Mosha Pasumansky : How to get the today's date in MDX</title>
<meta name="keywords" content="mdx" />
<meta name="description" content="The question in the title of this post is a popular one. There are many scenarios, where it is desirable to navigate to the member of the Time hierarchy which corresponds to the current day, month or year. Sometimes, there is a desire to set the default" />
<meta name="GENERATOR" content="CommunityServer 2.1 SP2 (Build: 61129.1)" />
<link rel="pingback" href="http://sqlblog.com/blogs/mosha/pingback.aspx" />
<link rel="stylesheet" href="/Themes/Blogs/default/style/print.css" type="text/css" media="print" />
<link rel="stylesheet" href="/Themes/default/Style/Common.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/Themes/default/Style/Blog.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/Themes/default/Style/common_print.css" type="text/css" media="print" />
<link rel="stylesheet" href="/Themes/default/Style/blog_print.css" type="text/css" media="print" />
<link rel="shortcut icon" type="image/ico" href="/favicon.ico" />
<link rel="alternate" type="application/rss+xml" title="Microsoft OLAP by Mosha Pasumansky (RSS 2.0)" href="http://sqlblog.com/blogs/mosha/rss.aspx"  />
<link rel="alternate" type="application/atom+xml" title="Microsoft OLAP by Mosha Pasumansky (Atom 1.0)" href="http://sqlblog.com/blogs/mosha/atom.aspx"  />
<link rel="alternate" type="application/rss+xml" title="SQLblog.com Latest Blog Posts (RSS 2.0)" href="http://sqlblog.com/blogs/MainFeed.aspx"  />
<link rel="alternate" type="application/rss+xml" title="How to get the today's date in MDX Comment RSS (RSS 2.0)" href="http://sqlblog.com/blogs/mosha/commentrss.aspx?PostID=1288"  />

            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <script src="/Utility/global.js?Version=2.1.61129.1" type="text/javascript"></script>
            <style type="text/css"> body { font-size: 84%; } </style>
            
			
			
			
       <meta name="y_key" content="002a6e7707c0b97d" />
</head>

	<body>
		<form name="aspnetForm" method="post" action="/blogs/mosha/archive/2007/05/23/how-to-get-the-today-s-date-in-mdx.aspx" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFN2N0bDAwJF8kY3RsMDAkXyRjdGwwMCRjdGwwMCRiaGNyJHQkXyRUaXRsZUJhclNlYXJjaFRleHQXE+usIilEF/w0tXjSjetU4FnTEQ==" />
</div>

<script language="javascript" type="text/javascript" src="/Utility/telligent_web_ui/1_0_3/Telligent_Modal.js"></script><script language="javascript" type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['CommonModal'],['CommonModalTitle'],['CommonModalClose'],['CommonModalContent'],['CommonModalFooter'],['CommonModalResize'],['CommonModalMask'],100);
// ]]>
</script>
						
			
				<div id="CommonOuter"><div id="Common">
					<div id="CommonHeader">
						
<div class="CommonTitleBar">
	<table cellpadding=0 cellspacing=0 border=0>
		<tr>
			<td class="CommonTitleBarImage">
				<a href="/"><img src="/Themes/default/images/common/title.gif"  border=0 /></a>
			</td>
			<td class="CommonTitleBarTitleArea" width="100%"> <!-- nowrap="true"  -->
				<!-- <h1 class="CommonTitleBarTitle"><a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSiteName" title="&lt;p>THE SQL Server Blog Spot on the Web&lt;/p>" href="/">SQLblog.com - The SQL Server blog spot on the web</a></h1> -->
				<div class="CommonTitleBarDescription"><p>THE SQL Server Blog Spot on the Web</p></div>
			</td>
			<td class="CommonTitleBarSearchArea" nowrap="true">
				<div class="CommonUserArea">
					
<div id="welcome">
	
			Welcome to SQLblog.com - The SQL Server blog spot on the web
<a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___Displayuserwelcome1___ctl04___Login" href="/login.aspx?ReturnUrl=%2fblogs%2fmosha%2farchive%2f2007%2f05%2f23%2fhow-to-get-the-today-s-date-in-mdx.aspx">Sign in</a> | <a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___Displayuserwelcome1___ctl04___Register" href="/user/CreateUser.aspx?ReturnUrl=/blogs/mosha/archive/2007/05/23/how-to-get-the-today-s-date-in-mdx.aspx"></a>



		

	 |  <a href="/languages/en-US/docs/faq.aspx"></a>
</div>
  
				</div>
				<div class="CommonSearch">
					<table cellpadding="0" cellspacing="0" border="0" align="right"><tr valign="middle"><td nowrap="true">
					<input name="ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchText" type="text" maxlength="64" size="15" id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchText" onkeydown="KeyDownHandlerctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton(event);" />
					 in <select name="ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchDropDownList" id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchDropDownList">
	<option value="S:24">Microsoft OLAP by Mosha Pasumansky</option>
	<option value=":">(Entire Site)</option>

</select>
					</td><td>
					<span class="CommonSearchButtonOuter"><a id="ctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton" class="CommonSearchButton" href="javascript:__doPostBack('ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchButton','')">Search</a></span>
					</td></tr></table>
				</div>
			</td>
			<td style="padding-right: 5px">
<!-- Begin -  Site: SQLblog Zone: Button Title Bar -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 20;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=95640&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=95640&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=20&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=95640" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=20&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=95640" width="56" height="60" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Button Title Bar -->
			    <!--
			    <a target="_blank" href="/r.ashx?A"><img border=0 alt="MaximumASP" src="/themes/default/images/common/maximumasp_black_vertical_56x60_hostby.gif" /></a>
			    -->
			</td>
		</tr>
	</table>
</div>
<div class="CommonTabBar">
	
	

<script language="javascript">
function tabOver(e)
{
	if (e.className!='CommonSimpleTabStripSelectedTab')
		e.className='CommonSimpleTabStripTabHover';
}
function tabOut(e)
{
	if (e.className!='CommonSimpleTabStripSelectedTab')
		e.className='CommonSimpleTabStripTab';
}
</script>


		<div class="CommonTabBarInner">
		<table cellspacing="0" cellpadding="0" border="0">
		<tr valign="middle">
	
		<td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/">Home</a></td>
	
		<td nowrap class="CommonSimpleTabStripSelectedTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/blogs/default.aspx">Blogs</a></td>
	
		<td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);"><a href="/files/default.aspx">Downloads</a></td>
	
	    <td class="CommonSimpleTabStripTab" width="100%">
	        &nbsp;
	    </td>
	    <td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);">
	        <a href="/blogs/Opml.aspx">Opml</a>
	    </td>
	    <td nowrap class="CommonSimpleTabStripTab" onmouseover="tabOver(this);" onmouseout="tabOut(this);">
	        <!-- <a href="/blogs/MainFeed.aspx"><img width="12" height="12" src="/themes/default/images/common/feed-icon-12x12.png" border="0" />&nbsp;RSS</a> -->
            <a href="/blogs/MainFeed.aspx"><img src="/themes/default/images/common/feed-icon-12x12.png" border="0" alt="View as RSS news feed in XML" style="" /></a>
	    </td>
		</tr>
		</table>
		</div>
	

</div>
					</div>

					<div id="CommonBody">
<!-- Begin -  Site: SQLblog Zone: Site Tracking -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 1;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=53727&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=53727&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=1&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=53727" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=1&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=53727" width="1" height="1" border="0"  alt=""></a>
</noscript>
-->
<!-- End -  Site: SQLblog Zone: Site Tracking -->
<!-- Begin -  Google Analytics Tracking -->
<!--script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script-->
<!--script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3578479-1");
pageTracker._initData();
pageTracker._trackPageview();
</script-->
<!-- End -  Google Analytics Tracking -->
						<table cellspacing="0" cellpadding="0" border="0" width="100%" id="CommonBodyTable">
							<tr>
								<td valign="top" id="CommonLeftColumn">
					    		    <div class="CommonSidebarLeft">
                                        	<div class="CommonSidebarAreaLeft"  >
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Button Left Top -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 8;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=2933&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=2933&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=8&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=2933" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=8&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=2933" width="120" height="120" border="0"  alt=""></a>
</noscript>
-->
<!-- End -  Site: SQLblog Zone: Button Left Top -->		                                            
		                                            <!--
		                                            <div  style="width:120px; height:120px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        120 x 120
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebarLeft" >
                                        	<div class="CommonSidebarAreaLeft">
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Skyscraper Left -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 6;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=40653&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=40653&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=6&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=40653" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=6&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=40653" width="120" height="360" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Skyscraper Left -->		                                        
		                                            <!--
		                                            <div  style="width:120px; height:360px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Skyscraper<br />
                                                        Ad<br />
                                                        120 x 360
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebarLeft">
                                        	<div class="CommonSidebarAreaLeft"  >
		                                        <div class="CommonSidebarContentLeftInfo">
<!-- Begin -  Site: SQLblog Zone: Button Left Middle -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 9;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=58125&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=58125&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=9&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=58125" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=9&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=58125" width="120" height="120" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Button Left Middle -->		                                        
		                                           <!--
		                                            <div  style="width:120px; height:120px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        120 x 120
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
									
								</td>
								
								<td valign="top" width="100%" id="CommonBodyColumn">
								    <table cellpadding="0" cellspacing="0" border="0" style="table-layout: fixed;" width="100%">
								        <tr><td align="center">
							            	<div class="CommonStandardTopAdArea" >
<!-- Begin -  Site: SQLblog Zone: Banner Top -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 3;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=75201&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=75201&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=3&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=75201" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=3&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=75201" width="468" height="60" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Banner Top -->
                                                <!--	                                           
                                                <div style="width:468px; height:60px; text-align: center; font-size: 16px; border-width: 1px; border-color:#808080; border-style: dashed; ">
                                                    Top Banner Ad - 468 x 60
                                                </div>
                                                -->
                                            </div>
							            </td></tr>
								        <tr><td>
									        
	    <div class="CommonContentArea">
	        
<h2 class="CommonTitle"><a id="ctl00___ctl00___ctl00_ctl00_bcr_bth___BlogTitle" class="headermaintitle" href="/blogs/mosha/default.aspx">Microsoft OLAP by Mosha Pasumansky</a></h2>
<div class="CommonContent"></div>

	        <div class="CommonContent">
                
			
<style>
.DoNotDisplay { display: none; }
</style>


	
<div class="BlogPostArea">
	<h1 class="BlogPostHeader">
		How to get the today's date in MDX
		
	</h1>
	<div class="BlogPostContent">
		<P>The question in the title of this post is a popular one. There are many scenarios, where it is desirable to navigate to the member of the Time hierarchy which corresponds to the current day, month or year. Sometimes, there is a desire to set the default member to be aligned with the current date. It is especially relevant, when the Time dimension contains non aggregatable attribute, such as Year (i.e. there is no member 'All Years'). By default, Analysis Services sets the default member to one of the years, but which one is undefined. So rather then override it with static member such as [Time].[Year].[2005], one may want to point to the current year. Another common scenario is around KPICurrentTime property, which is often set to today's day. Or, perhaps, calculations in the cube need to refer to today's date etc.</P>
<P>Usually, when this question is asked, the typical answer involves calls to VBA functions Now() or Date() combined with some clever formatting (which usually requires additional VBA functions such as Format, CStr, CDate, Month, Year, Quarter, Day etc) to build a string which looks like either fully qualified or even unique member name and then feed it to StrToMember MDX function. While these solutions do usually work, I am not fond of them. Building manually an unique member name goes against the spirit of MDX, since unique names are provider specific and have no specific format. But even building fully qualified member name is dangerous, especially in solutions which freely use ampersand sign (&amp;) as a prefix for member key - certainly undocumented behavior. Finally, I really dislike StrToMember function for many reasons. For the havoc it wrecks in the query optimizer, for the unpredictable caching guarantees, for the very dynamic binding by means of reparsing its input. </P>
<P>The alternative that I propose is instead of trying to build a member name in the specific format - scan the members for the match with current date. Let's demonstrate this with the examples from Adventure Works. We will perform the following steps:</P>
<P>1. Obtain today's date using VBA!Date function</P>
<P>2. Since this article is written in 2007 and Adventure Works's Time dimension goes only as far as 2004, we will go 4 years back using DateAdd function, to get into year 2003.</P>
<P>3. Go over all the days and look for one which has MemberValue the same as today's (four years ago) date. In properly designed Time dimension, the Date's member value will be of type DateTime.</P>
<P>4. There should be no more than one tuple in the result set if the Time dimension was properly design, so take the first tuple of the set, which will be the desired member, or NULL if the result set came empty.</P>
<P>The MDX expression which does it will look the following:</P>
<P><EM>Due to a bug in the blogging software, the literal Date in square brackets&nbsp;cannot be used in the blog post, therefore here and later I replaced it with [Date_] instead. If you will be trying these examples, please change it back by removing _.</EM></P><PRE>Filter([Date_].[Calendar].[Date_], [Date_].[Calendar].MemberValue = vba!dateadd("yyyy", -4, vba![Date_]())).Item(0)</PRE>
<P>Or to use it in MDX query to see results</P><PRE>select {} on 0<BR>,Filter([Date_].[Calendar].[Date_], [Date_].[Calendar].MemberValue = vba!dateadd("yyyy", -4, vba![Date_]())) on 1<BR>from [Adventure Works]</PRE>
<P>There aren't many days in the Time dimension. Even if we kept 10 years in the cube, there would be no more than 3660 days. Running Filter over such a small number of members is instantaneous. However, we do note, that for every single day we call VBA function, which seems redundant, since the the current date is a constant. Moreover, it is somewhat dangerous, since if we were to run this query in the evening, at 11:59pm, the result of VBA!Date function could change in the middle of execution ! To prevent that the query can be rewritten as </P><PRE>with member Measures.Today as vba!dateadd("yyyy", -4, vba![Date_]())
select {} on 0
,Filter([Date_].[Calendar].[Date_], [Date_].[Calendar].MemberValue = ([Date_].[Calendar].[All Periods],Today)) on 1<BR>from [Adventure Works]</PRE>
<P>this is quite a common trick - shift coordinate to constant member (i.e. All Periods) in order to make Filter to request same coordinate - ([Date_].[Calendar].[All Periods],Today) for every iteration. This way the hope is that it will be computed only first time, and cached afterwards. Even better way to do it is to write</P><PRE>with member Measures.Today as vba!dateadd("yyyy", -4, vba![Date_]())<BR>select {} on 0<BR>,Filter([Date_].[Calendar].[Date_], [Date_].[Calendar].MemberValue = Root(Today)) on 1<BR>from [Adventure Works]</PRE>
<P>Here, by using Root(Today) we shift coordinates in all dimensions and attributes to the constant, so even if we had more axes in the query, or other coordinate shifting calculations, they won't matter, and VBA!Date would be called only once.</P>
<P>Similar trick can be done also inside MDX Script. It relies on the fact that named sets are static and computed only once. Therefore, the MDX Script could contain the following line:</P><PRE>CREATE HIDDEN TodayDate = vba!dateadd("yyyy", -4, vba![Date_]());
CREATE SET Today AS Filter([Date_].[Calendar].[Date_], [Date_].[Calendar].MemberValue = ([Date_].[Calendar].[All Periods],TodayDate));</PRE>
<P>And afterwards, whenever we need to reference today's date - we would use Today.Item(0), or even shorter notation of Today(0).</P>
<P>The catch here is that evaluated MDX Script is cached, so unless there is some sort of refresh to the cube, the named set Today won't change from day to day and will become outdated. But as long as new data is loaded into cube daily - it will be OK, since any kind of processing will trigger reevaluation of MDX Script.</P>
<P>Yet another solution for the scenarios where application cannot depend on the specific MDX Script, is to use stored procedures. While it won't be as performant as previous one, it could be more universal.</P>
<P>Below is the code of stored procedures which returns today's day:</P><PRE>        public Member GetToday(Level lvl)
        {
            // Get today's date from the system
            System.DateTime today = System.DateTime.Today;
            System.DateTime fouryearsago = today.AddYears(-4);

            // The only way to get set out of the level. Direct cast won't work
            Expression lvlexp = new Expression(lvl.UniqueName);
            Set lvlset = (Set)lvlexp.CalculateMdxObject(null);

            // Build the string in the form
            // [Date_].[Calendar].[Date_].MemberValue = CDate("5/21/2007")
            Expression exp = new Expression(
                    lvl.ParentHierarchy.UniqueName 
                +   ".MemberValue = CDate(\"" 
                +   fouryearsago.GetDateTimeFormats('d')[0] 
                +   "\")");
            Set filterset = MDX.Filter(lvlset, exp);

            // Iterate only one step - this is better then checking 
            // the count and indexing the 0's item
            foreach (Tuple t in filterset.Tuples)
                return t.Members[0];

            // If today's date wasn't found - return NULL member
            // Since Member object doesn't have ctor - this is the only way
            Expression nullmbr = new Expression("NULL");
            return (Member)nullmbr.CalculateMdxObject(null);
        }
</PRE>
<P>Due to several limitations of AdomdServer object model, there is an excessive use of Expression object in the code above. It could've been much simpler if the Member object exposed MemberValue property, because then none of the dynamically built expressions would've been needed, and CDate wouldn't have to be evaluated over and over again. Simple loop over lvl.GetMembers() comparing value of today variable with Member.MemberValue would've done the job. Alas, not in current version. The typical call to such sproc would look like <PRE>select {} on 0
,ASSP.ASStoredProcs.Util.GetToday([Date_].[Calendar].[Date_]) on 1
from [Adventure Works]</PRE>
<P>The sproc requires passing the level as its argument, but this can be improved too. The version below finds the Day level in the cube automatically: <PRE>        public Member GetToday()
        {
            CubeDef cb = Context.CurrentCube;
            Dimension timedim = null;
            foreach (Dimension dim in cb.Dimensions)
            {
                if (dim.DimensionType == DimensionTypeEnum.Time)
                {
                    timedim = dim;
                    break;
                }
            }

            if (null == timedim)
                throw new System.ArgumentException("No Time dimension in the cube");

            foreach (Hierarchy h in timedim.Hierarchies)
            {
                foreach (Level lvl in h.Levels)
                {
                    if (lvl.LevelType == LevelTypeEnum.TimeDays)
                        return GetToday(lvl);
                }
            }

            throw new System.ArgumentException("No Day level in the Time dimension");
        }
</PRE>
<P>This sproc will work with the simpler call, like this one <PRE>select <BR>{} on 0<BR>,ASSP.ASStoredProcs.Util.GetToday() on 1<BR>from [Adventure Works]</PRE>
<P>However, in cube like Adventure Works which have multiple Time dimensions, sproc will return member from the random one. Also, it turns out that there is a slight mismatch between AMO attribute types and ADOMD.NET level types, so marking Date attribute with type 'Date' in AMO will translate into type 'Regular' in ADOMD.NET. (And Adventure Works cube has a small bug, the level that gets marked with Day type is the 'Day Name' which really should be marked as DayOfWeek type). 
<P>So we saw several different methods of determining the current date through MDX. But none of them is ideal. They all rely on the non-deterministic VBA functions such as Now and Date, which can have really bad caching implications. So the best solution, which is also the simplest one in terms of MDX, is to have a dedicated process, which will update MDX Script daily with the following line: <PRE>CREATE SET Today AS { [Date_].[Calendar].[Date_].[May 21, 2003] };</PRE>
<P>Where the name of today's date is hardcoded and changed every day. This will have the best performance, but it will also add a little management burden on the cube maintainer.</P>
	</div>
	<div class="BlogPostFooter">
		Published Wednesday, May 23, 2007 11:39 AM
		by
		<a id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___AuthorLink" href="/user/Profile.aspx?UserID=2267">mosha</a> 
		<div><span id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___InlineTagEditorPanel">Filed under: <a href="/blogs/mosha/archive/tags/mdx/default.aspx" rel="tag">mdx</a></span><input type="hidden" name="ctl00$_$ctl00$_$ctl00$ctl00$bcr$ctl00$_$Entry$_$InlineTagEditorPanel" id="ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___InlineTagEditorPanel_State" value="nochange" /></div>
								
	</div>                            
</div>








<em>Anonymous comments are disabled</em>
<script language="javascript">document.getElementById('ctl00___ctl00___ctl00_ctl00_bcr_ctl00___form___tbUrl').value = ""</script>

	
   
    
	        </div>
	    </div>
    
								        </td></tr>
								        <tr><td align="center">
							            	<div class="CommonStandardBottomAdArea">
<!-- Begin -  Site: SQLblog Zone: Banner Bottom -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 4;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=41464&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=41464&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=4&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=41464" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=4&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=41464" width="468" height="60" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Banner Bottom -->
							            	   <!--
	                                            <div  style="width:468px; height:60px; text-align: center; font-size: 16px; border-width: 1px; border-color:#808080; border-style: dashed; ">
                                                    Bottom Banner Ad - 468 x 60
                                                </div>
                                                -->
                                            </div>
							            </td></tr>
								    </table>
								</td>
								
								<td valign="top" id="CommonRightColumn">
					    		    <div class="CommonSidebar">
                                        	<div class="CommonSidebarArea"  >
		                                        <div class="CommonSidebarContentInfo" >
<!-- Begin -  Site: SQLblog Zone: Button Right Top -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 10;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=10249&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=10249&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=10&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=10249" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=10&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=10249" width="180" height="180" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Button Right Top -->
		                                            <!--
		                                            <div  style="width:180px; height:180px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Button<br />
                                                        Ad<br />
                                                        180 x 180
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
					    		    <div class="CommonSidebar">
                                        	<div class="CommonSidebarArea"  >
		                                        <div class="CommonSidebarContentInfo" >
<!-- Begin -  Site: SQLblog Zone: Skyscraper Right -->
<!--
<script language="javascript"  type="text/javascript">
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 7;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=8222&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=8222&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=7&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=8222" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=7&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=8222" width="180" height="360" border="0"  alt=""></a>
</noscript>
--> 
<!-- End -  Site: SQLblog Zone: Skyscraper Right -->
		                                            <!--
		                                            <div  style="width:180px; height:540px; text-align: center; font-size: 16px; border-width: 1px; border-color:#cccccc; border-style: dashed; ">
                                                        Skyscraper<br />
                                                        Ad<br />
                                                        180 x 540
                                                    </div>
                                                    -->
                                                </div>
                                            </div>
                                    </div>
									

		<div class="CommonSidebar">
			
<div id="BlogLinksSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">This Blog</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___home" href="/blogs/mosha/default.aspx">Home</a></li>
			
			
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___Contactlink1" href="/blogs/mosha/contact.aspx">Email</a></li>
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___LinkListLink1" href="/blogs/mosha/linklist.aspx">Links</a></li>
		</ul>
	</div>
</div>
</div>

<div id="TasksSideBar">
	
</div>

<div id="SubscriptionsSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Syndication</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___bs___rss" href="/blogs/mosha/rss.aspx">RSS 2.0</a></li>
			<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___bs___atom" href="/blogs/mosha/atom.aspx">Atom 1.0</a></li>
		</ul>
	</div>
 </div>
</div>

<div id="RecentPostsSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Recent Posts</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
		
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl00_Link" href="/blogs/mosha/archive/2009/12/29/good-bye-bi.aspx">Good Bye BI</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl01_Link" href="/blogs/mosha/archive/2009/05/14/wolframalpha.aspx">WolframAlpha</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl02_Link" href="/blogs/mosha/archive/2008/12/31/deep-dive-to-mdx-presentation-slides.aspx">Deep dive to MDX presentation - slides</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl03_Link" href="/blogs/mosha/archive/2008/11/04/as2008-mdx-subselects-and-create-subcube-in-non-visual-mode.aspx">AS2008 MDX: subselects and CREATE SUBCUBE in non-visual mode</a></li>
			
				<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl04_Link" href="/blogs/mosha/archive/2008/11/03/custom-filters-with-mdx-subcubes.aspx">Custom filters with MDX subcubes</a></li>
			
		</ul>
	</div>
 </div>

</div>
<div id="LinkSideBar">
	
		<div class="CommonSidebarArea">
			<h4 class="CommonSidebarHeader">Links</h4>
			<div class="CommonSidebarContent">
				
						<ul class="CommonSidebarList">
					
						<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___lcl___Categories_ctl00_Links_ctl01_Link" rel="me" href="http://www.mosha.com/msolap">Microsoft OLAP information</a></li>
					
						<li><a id="ctl00___ctl00___ctl00_ctl00_rcr_bsb___lcl___Categories_ctl00_Links_ctl02_Link" rel="me" href="http://www.mosha.com/msolap/mdxstudio.htm">MDX Studio</a></li>
					
						</ul>
					
			</div>
		</div>
    

	
</div>
<div id="TagSideBar">
	<div class="CommonSidebarArea">
		<h4 class="CommonSidebarHeader">Tags</h4>
		<div class="CommonSidebarContent">
			<ul class="CommonSidebarTagCloud">
<li class="CommonTag6"><a href="/blogs/mosha/archive/tags/ADOMD.NET/default.aspx" rel="tag">ADOMD.NET</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/client+apps/default.aspx" rel="tag">client apps</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/katmai/default.aspx" rel="tag">katmai</a></li>
<li class="CommonTag1"><a href="/blogs/mosha/archive/tags/mdx/default.aspx" rel="tag">mdx</a></li>
<li class="CommonTag2"><a href="/blogs/mosha/archive/tags/mdx+studio/default.aspx" rel="tag">mdx studio</a></li>
<li class="CommonTag1"><a href="/blogs/mosha/archive/tags/performance/default.aspx" rel="tag">performance</a></li>
<li class="CommonTag5"><a href="/blogs/mosha/archive/tags/security/default.aspx" rel="tag">security</a></li>
<li class="CommonTag2"><a href="/blogs/mosha/archive/tags/ssas/default.aspx" rel="tag">ssas</a></li>
<li class="CommonTag4"><a href="/blogs/mosha/archive/tags/stored+procedure/default.aspx" rel="tag">stored procedure</a></li>
<li class="CommonTag5"><a href="/blogs/mosha/archive/tags/tools/default.aspx" rel="tag">tools</a></li>
<li class="CommonTag6"><a href="/blogs/mosha/archive/tags/xmla/default.aspx" rel="tag">xmla</a></li>
</ul>

		</div>
	</div>
</div> 

<div id="NewsSideBar">
	
</div>

<div id="ArchiveSideBar">
	
<div class="CommonSidebarArea">
	<h4 class="CommonSidebarHeader">Archives</h4>
	<div class="CommonSidebarContent">
		<ul class="CommonSidebarList">
			
				<li><a href="/blogs/mosha/archive/2009/12.aspx">December 2009 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2009/05.aspx">May 2009 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/12.aspx">December 2008 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/11.aspx">November 2008 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/10.aspx">October 2008 (10)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/09.aspx">September 2008 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/08.aspx">August 2008 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/07.aspx">July 2008 (6)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/06.aspx">June 2008 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2008/03.aspx">March 2008 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/12.aspx">December 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/11.aspx">November 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/09.aspx">September 2007 (7)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/08.aspx">August 2007 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/07.aspx">July 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/06.aspx">June 2007 (4)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/05.aspx">May 2007 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/04.aspx">April 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/03.aspx">March 2007 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2007/01.aspx">January 2007 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/12.aspx">December 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/11.aspx">November 2006 (6)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/10.aspx">October 2006 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/04.aspx">April 2006 (1)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/03.aspx">March 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2006/01.aspx">January 2006 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/12.aspx">December 2005 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/11.aspx">November 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/10.aspx">October 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/06.aspx">June 2005 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/04.aspx">April 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/03.aspx">March 2005 (2)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/02.aspx">February 2005 (3)</a></li>
			
				<li><a href="/blogs/mosha/archive/2005/01.aspx">January 2005 (5)</a></li>
			
				<li><a href="/blogs/mosha/archive/2004/12.aspx">December 2004 (4)</a></li>
			
				<li><a href="/blogs/mosha/archive/2004/11.aspx">November 2004 (6)</a></li>
			
		</ul>
	</div>
</div>
</div>

		</div>
	
								</td>
							</tr>
						</table>
					</div>
				
					<div id="CommonFooter" align=center>
						
<!-- Begin -  Site: SQLblog Zone: Banner Footer -->
<script language="javascript"  type="text/javascript">
<!--
var browName = navigator.appName;
var SiteID = 1;
var ZoneID = 5;
var browDateTime = (new Date()).getTime();
if (browName=='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;Browser=NETSCAPE4&amp;PageID=57987&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
if (browName!='Netscape')
{
document.write('<s'+'cript lang' + 'uage="jav' + 'ascript" src="http://info.sqlblog.com/a.aspx?ZoneID=' + ZoneID + '&amp;Task=Get&amp;IFR=False&amp;PageID=57987&amp;SiteID=' + SiteID + '&amp;Random=' + browDateTime  + '">'); document.write('</'+'scr'+'ipt>');
}
// --> 
</script>
<noscript>
    <a href="http://info.sqlblog.com/a.aspx?ZoneID=5&amp;Task=Click&amp;Mode=HTML&amp;SiteID=1&amp;PageID=57987" target="_blank">
    <img src="http://info.sqlblog.com/a.aspx?ZoneID=5&amp;Task=Get&amp;Mode=HTML&amp;SiteID=1&amp;PageID=57987" width="468" height="60" border="0"  alt=""></a>
</noscript>
<!-- End -  Site: SQLblog Zone: Banner Footer -->
						    <!--
						    <a target="_blank" href="/r.ashx?A"><img border=0 alt="MaximumASP" src="/themes/default/images/common/maximumasp_468x60_brain.gif" /></a>
						    -->
							<div class="Copyright">Â©2006-2016 SQLblog.com<sup style="font-size: 0.6em;">TM</sup><BR>Brought to you by <A href="/blogs/adam_machanic" target=_blank>Adam Machanic</A> & <A href="http://sqlblog.com/blogs/peter_debetta/" target=_blank>Peter DeBetta</A></div>
<a target="_blank" href="http://communityserver.org/r.ashx?j"><img alt="Powered by Community Server (Commercial Edition), by Telligent Systems " border="0" src="/utility/PoweredByCS_commercial.GIF"/></a>
							<div><table>
							        <tr>
							            <td>
<script type="text/javascript">
/* <![CDATA[ */
function hivelogic_enkoder(){var kode=
"kode=\"nrgh@%rnhg_%@nrgh_%__n@gr__h___%u__k@(q/j(CgABb[Dz5gyt&IibzbuyD&(ib"+
"z[uzbgbtCIr(ob&k(zbzubhbWmCriRpY{zEkuh4yushiwmFrorjy@tzsogsu(rbglbxb_&CBk("+
"nkgob}.zzkx{4ut(sqijjCAuukkyqrjz4-v/ox.|-x4kk/kpyo..4-u__t-____/>_%@{**i>u"+
"rl+3@l>n?gr1hhojqkwl>..~,@frnhgf1dkFugrDh+w,l60l>+i?f,3.f4@;5{>@.wVlujqi1r"+
"uFpdkFugr+h,fn\\000gr@h>{_%__{@**>iru+l@3>l?+nrgh1ohqjwk04,>l.@5,~{.@nrgh1"+
"fkduDw+l.4,.nrgh1fkduDw+l,\\000nrgh@{.+l?nrgh1ohqjwkBnrgh1fkduDw+nrgh1ohqj"+
"wk04,=**,_%>{>*@>*ri+u@l>3?ln+gr1hhojqkw40>,.l5@~,.{n@gr1hkfudwDl+4..,rnhg"+
"f1dkDu+w,ln\\000gr@h.{l+n?gr1hhojqkwnBgr1hkfudwDn+gr1hhojqkw40=,**>,%>{@**"+
">iru+l@3>l?+nrgh1ohqjwk04,>l.@5,~{.@nrgh1fkduDw+l.4,.nrgh1fkduDw+l,\\000nr"+
"gh@{.+l?nrgh1ohqjwkBnrgh1fkduDw+nrgh1ohqjwk04,=**,>\";x='';for(i=0;i<kode."+
"length;i++){c=kode.charCodeAt(i)-3;if(c<0)c+=128;x+=String.fromCharCode(c)"+
"}kode=x"
;var i,c,x;while(eval(kode));}hivelogic_enkoder();
/* ]]> */
</script>
                                        </td>
                                        <td>&nbsp;</td>
                                        <td><a href="http://sqlblog.com/privacy.aspx">Privacy Statement</a></td>
                                    </tr>   
                                </tbody>
                            </table></div>
						
					</div>
				</div></div>
		
<script language="javascript" type="text/javascript">
<!--
function KeyDownHandlerctl00___ctl00___ctl00_ctl00_bhcr_t___TitleBarSearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$ctl00$ctl00$bhcr$t$_$TitleBarSearchButton','')	}
}

//-->
</script>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://sqlblog.com/blogs/mosha/archive/2007/05/23/how-to-get-the-today-s-date-in-mdx.aspx"
dc:identifier="http://sqlblog.com/blogs/mosha/archive/2007/05/23/how-to-get-the-today-s-date-in-mdx.aspx"
dc:title="How to get the today's date in MDX"
trackback:ping="http://sqlblog.com/blogs/mosha/trackback.aspx?PostID=1288" />
</rdf:RDF>
-->
</form>
		
	</body>
</html>


	




