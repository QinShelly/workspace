WITH  
MEMBER [Measures].[TotalUnits Positive]
AS IIF([Total Sales Volume Units] > 0, [Total Sales Volume Units], NULL)
MEMBER [Measures].[TotalSales Positive]
AS IIF([Total Sales Amount] > 0, [Total Sales Amount], NULL)

member [First Scan Date InternalY]  as
([CALENDAR].[Ad Week Ended].[all], [First Plan Date Internal],[UNIQUES TYPE].[TY SCAN].&[1],
 [DISTINCT TYPE].[KEY TYPE].&[1])


member [Measures].[First Scan Date Y] AS
IIF([Measures].[First Scan Date InternalY] = 0 or [Measures].[Plan Item Count] = 0 , null, DateValue(
	Left(CSTR([Measures].[First Scan Date InternalY]), 4)
	+ "-" + Mid(CSTR([Measures].[First Scan Date InternalY]), 5, 2)
	+ "-" + Right(CSTR([Measures].[First Scan Date InternalY]), 2)
	) 
)
 

MEMBER [Measures].[lcd] AS 'iif([First Scan Date InternalY] = null, null, format(datevalue(tail(existing(calendar.[date].[date])).item(0).member_name),"MM-dd-yyyy"))', SOLVE_ORDER=10 
MEMBER [Measures].[p1ap] AS '((existing(calendar.[Ad Week Ended].&[201543])).item(0),[Measures].[TotalUnits Positive])', SOLVE_ORDER=10 , format_string='0' 
MEMBER [Measures].[p2ap] AS '((existing(calendar.[Ad Week Ended].&[201544])).item(0),[Measures].[TotalUnits Positive])', SOLVE_ORDER=10 , format_string='0' 
MEMBER [Measures].[p3ap] AS '((existing(calendar.[Ad Week Ended].&[201545])).item(0),[Measures].[TotalUnits Positive])', SOLVE_ORDER=10 , format_string='0' 
MEMBER [Measures].[p4ap] AS '((existing(calendar.[Ad Week Ended].&[201546])).item(0),[Measures].[TotalUnits Positive])', SOLVE_ORDER=10 , format_string='0' 
MEMBER [Measures].[p5ap] AS '((existing(calendar.[Ad Week Ended].&[])).item(0),[Measures].[TotalUnits Positive])', SOLVE_ORDER=10 , format_string='0' 
MEMBER [Measures].[p6ap] AS '((existing(calendar.[Ad Week Ended].&[201543])).item(0),[Measures].[TotalSales Positive])', SOLVE_ORDER=10 , format_string='0.00' 
MEMBER [Measures].[p7ap] AS '((existing(calendar.[Ad Week Ended].&[201544])).item(0),[Measures].[TotalSales Positive])', SOLVE_ORDER=10 , format_string='0.00' 
MEMBER [Measures].[p8ap] AS '((existing(calendar.[Ad Week Ended].&[201545])).item(0),[Measures].[TotalSales Positive])', SOLVE_ORDER=10 , format_string='0.00' 
MEMBER [Measures].[p9ap] AS '((existing(calendar.[Ad Week Ended].&[201546])).item(0),[Measures].[TotalSales Positive])', SOLVE_ORDER=10 , format_string='0.00' 
MEMBER [Measures].[p10ap] AS '((existing(calendar.[Ad Week Ended].&[])).item(0),[Measures].[TotalSales Positive])', SOLVE_ORDER=10 , format_string='0.00' 

MEMBER [Measures].[fcd] AS 'iif([First Scan Date Internal] = null, "", 
      Mid(CSTR([Measures].[First Scan Date Internal]), 5, 2)
      + "-" + Right(CSTR([Measures].[First Scan Date Internal]), 2)
      + "-" + Left(CSTR([Measures].[First Scan Date Internal]), 4)
)', SOLVE_ORDER=10 

SELECT 
nonempty(
{[STORE].[RETAILER NAME].[RETAILER NAME]}
* {[STORE].[STORE].[STORE]}
* {[PRODUCT].[UPC].[UPC]}
,
{ 
[Measures].[p1ap], [Measures].[p2ap], [Measures].[p3ap], [Measures].[p4ap], [Measures].[p5ap],[Measures].[p6ap], [Measures].[p7ap], [Measures].[p8ap], [Measures].[p9ap], [Measures].[p10ap]
}
)
ON ROWS 
,  { 
[Measures].[lcd], [Measures].[p1ap], [Measures].[p2ap], [Measures].[p3ap], [Measures].[p4ap], [Measures].[p5ap],[Measures].[p6ap], [Measures].[p7ap], [Measures].[p8ap], [Measures].[p9ap], [Measures].[p10ap],  [Measures].[fcd]
}  ON COLUMNS FROM  
( 
SELECT ( 
{[PRODUCT].[UPC].[07940000879],[PRODUCT].[UPC].[07940001743],[PRODUCT].[UPC].[07940006147]}
) ON 0 FROM [ULEVER_FLION_V1] ) 
WHERE ( [CALENDAR].[Ad].[Ad Week Ended].&[201543]:[CALENDAR].[Ad].[Ad Week Ended].&[201546], [STORE].[BANNER NAME].&[FOOD LION] 
)  CELL PROPERTIES VALUE, FORMATTED_VALUE

